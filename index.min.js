"use strict";function elattr(obj,attr){if(obj&&obj.nodeType&&attr&&attr instanceof Object)for(var akey in attr)obj[akey]=attr[akey];return obj}function element(name,attr,data){var tag=document.createElement(name);return elattr(tag,attr),elchild(tag,data),tag}function elchild(obj,value){if(obj&&value)if(value.nodeType)obj.appendChild(value);else if(value instanceof Array)for(var i=0;i<value.length;i++)elchild(obj,value[i]);else obj.appendChild(document.createTextNode(value));return obj}function elclear(obj){if(null!==obj&&obj.nodeName&&obj.hasChildNodes())for(;obj.hasChildNodes();)obj.removeChild(obj.firstChild);return obj}function loadScript(src,onload){var elem=element("script",{type:"text/javascript",src:src});onload instanceof Function&&(elem.onload=onload),document.head.appendChild(elem)}function getCurrentLanguage(){return gSTB.RDir("getenv language").toLowerCase()||"en"}function eventPrepare(event,stopBubble,label){return event.code?!0:(event.code=event.keyCode||event.which,0===event.code?!1:(event.shiftKey&&(event.code+=1e3),event.altKey&&(event.code+=2e3),stopBubble!==!1&&event.stopPropagation(),echo(event.code+"	"+event.shiftKey+"	"+event.ctrlKey+"	"+event.altKey+"	"+event.srcElement.id+"	"+event.target.id+"	"+(label||""),"keyDown [code/shift/ctrl/alt/src/target]"),!0))}function extend(target,source,override){var _target=override===!1?extend({},target):target||{};for(var prop in source)"object"!=typeof _target[prop]||"object"!=typeof source[prop]||Array.isArray(_target[prop])||Array.isArray(source[prop])?_target[prop]=source[prop]:_target[prop]=extend(_target[prop],source[prop],override);return _target}function ajax(method,url,callback,headers,ansvType,async,data){var hname,xhr=new XMLHttpRequest;if(xhr.onreadystatechange=function(){4===xhr.readyState&&callback("xml"===ansvType?xhr.responseXML:"json"===ansvType?JSON.parse(xhr.responseText):xhr.responseText,xhr.status)},xhr.open(method,url,void 0===async?!0:async),headers)for(hname in headers)xhr.setRequestHeader(hname,headers[hname]);return xhr.send(data||null),xhr}function getStorageInfo(){var snList={},info=JSON.parse(gSTB.GetStorageInfo("{}"));Array.isArray(info.result)&&""===info.errMsg&&info.result.length>0?(info.result.forEach(function(item){item.mediaType="000022272228"===item.sn?3:item.mediaType,item.label=item.label.trim(),snList[item.sn]?snList[item.sn]++:snList[item.sn]=1}),info.result.forEach(function(item){item.label||(item.label=item.vendor+" "+item.model.replace(/\//,""),snList[item.sn]>1&&(item.label+=" #"+item.partitionNum))}),info.result.sort(function(a,b){return a.mountPath<b.mountPath?-1:1}),window.STORAGE_INFO=info.result):window.STORAGE_INFO=[];try{window.HDD_INFO=JSON.parse(gSTB.RDir("get_hdd_info")||"[]")}catch(e){echo(e,"get_hdd_info"),window.HDD_INFO=[]}echo(STORAGE_INFO,"STORAGE_INFO"),echo(HDD_INFO,"HDD_INFO")}function CBase(parent){this.name="CBase",this.handle=null,this.parent=null,this.handleInner=null,this.showAttr="block",this.baseClass="",this.prevFocus=null,this.isActive=!1,this.activeChild=null,this.isVisible=!0,this.SetParent(parent)}function CPage(parent){CBase.call(this,parent||null),this.name="CPage",this.previous=null,this.isVisible=!1}function CScrollList(parent){CBase.call(this,parent),this.name="CScrollList",this.baseClass="cslist-main",this.activeItem=null,this.states={},this.defaultParams={hidden:!1,marked:!1,disabled:!1,focused:!1,href:"#",self:this,oncontextmenu:function(){return oldSystemType&&this.self.Focused(this,!0),!1},onclick:function(){return this.self.Focused(this,!0),!1},onmouseover:function(){return oldSystemType||this.self.Focused(this,!0),!1}},this.defaultFilter={hidden:!1,disabled:!1},this.itemsPerPage=0,this.itemHeight=0,this.scrollMode=2}function CSearchBar(parent){CBase.call(this,parent),this.name="CSearchBar",this.baseClass="csbar-main",this.filter="",this.path="",this.items={},this.timer=0,this.hint=0}function CGroupMenu(parent){CBase.call(this,parent),this.name="CGroupMenu",this.baseClass="cgmenu-main",this.activeGroup=null,this.active=!1,this.autoFocus=!0}function CSimpleSelect(parent,parameters){this.parameters=parameters||{},this.tagName="SELECT",this.attributes={content:{className:"csimple-select-content"},left_arrow:{className:"csimple-select-arrow left"},right_arrow:{className:"csimple-select-arrow right"},wrapper:{className:"csimple-select-wrapper",tabIndex:"1"},content_wrapper:{className:"csimple-content-wrapper"},hint:{className:"csimple-select-hint csimple-select-content"}},this.style=parameters.style||"",this.type="select",void 0!==parameters.attributes&&extend(this.attributes,parameters.attributes),this.bind(parameters.events||{}),CBase.call(this,parent||null),(this.parentNode=parameters.parent)||(void 0===parameters.content?this.parentNode=element("div"):this.parentNode=parameters.content.parentNode)}function CSelectBox(parent,parameters){CSimpleSelect.call(this,parent||null,parameters),this.attributes.wrapper.className+=" cselect-box",this.Init(this.GenerateHandle());var _selectedIndex,_default,_data=parameters.data||[],idField=parameters.idField||"id",nameField=parameters.nameField||"name",self=this;this.name=parameters.name||"CSelectBox",this.dropdown=new CSelectDropdown(this,{select:this,scrollMode:2,container:parameters.container}),this.SetData=function(data){if(0===data.length)throw"data cannot be empty";_data=data||[],data.length-1<_selectedIndex&&(_selectedIndex=data.length-1),self.RefreshContent(),self.trigger("dataChanged")},this.GetNameField=function(){return nameField},this.GetIdField=function(){return idField},this.GetData=function(){return _data},this.Autocomplete=function(keyCode){},this.ClearAutocomplete=function(){},this.GetSelected=function(){return _data[_selectedIndex]},this.Next=function(){_selectedIndex<_data.length-1&&this.SetIndex(++_selectedIndex)},this.Previous=function(){0!==_selectedIndex&&this.SetIndex(--_selectedIndex)},this.GetValue=function(){var selected=self.GetSelected();return"object"==typeof selected?selected[idField]:selected},this.GetLabel=function(){var selected=self.GetSelected();return"object"==typeof selected?selected[nameField]:selected},this.RefreshContent=function(){return self.SetContent(self.GetLabel()),self.value=self.GetValue(),1===self.GetData().length?(self.DisableElement(self.leftArrow,!0),void self.DisableElement(self.rightArrow,!0)):void(0===self.GetIndex()?(self.DisableElement(self.leftArrow,!0),self.DisableElement(self.rightArrow,!1)):self.GetIndex()===self.GetData().length-1?(self.DisableElement(self.rightArrow,!0),self.DisableElement(self.leftArrow,!1)):(self.DisableElement(self.leftArrow,!1),self.DisableElement(self.rightArrow,!1)))},this.SelectById=function(id,quiet){for(var i=0;i<_data.length;i++)if(_data[i][idField]===id)return self.SetIndex(i,quiet),i},this.IsChanged=function(){return _selectedIndex!==_default},this.GetIndex=function(){return _selectedIndex},this.SetIndex=function(index,quiet){var old=this.GetSelected();self.ClearAutocomplete(),_selectedIndex=void 0===index||index>=_data.length?0:index,self.RefreshContent(),quiet!==!0&&self.trigger("onChange",{"new":self.GetSelected(),old:old})},this.SetIndex(parameters.selected,!0),void 0!==parameters.selectedId&&this.SelectById(parameters.selectedId,!0),_default=_selectedIndex,this.EventHandler=function(event){switch(eventPrepare(event),event.stopped=!0,event.code){case KEYS.FRAME:this.dropdown.Show(!this.dropdown.isVisible,!1);break;case KEYS.LEFT:case KEYS.RIGHT:this.dropdown.isVisible||(CSimpleSelect.prototype.EventHandler.call(this,event),this.dropdown.EventHandler(event));break;case KEYS.OK:case KEYS.UP:case KEYS.DOWN:case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:event.stopped=!1,this.dropdown.isVisible&&(this.dropdown.EventHandler(event,null,!1),event.stopped=!0);break;case KEYS.EXIT:this.dropdown.isVisible?this.dropdown.Show(!1,!1):event.stopped=!1;break;default:event.stopped=!1}},this.handle.onkeypress=function(event){event.ctrlKey!==!0&&event.altKey!==!0&&self.Autocomplete(event.charCode)},this.dropdown.Refresh(),this.bind("onBlur",function(){self.ClearAutocomplete()})}function CSelectDropdown(parent,options){CScrollList.call(this,parent||null,options);var self=this;this.isVisible=!1,this.manageFocus=!1,this.multipleSelection=!1,this.attributes={wrapper:{className:"csimple-select-dropdown"},element:{className:"dropdown-element"}},this.select=null,this.baseClass="csimple-dropdown-main",CSelectDropdown.parameters.forEach(function(key){void 0!==options[key]&&(self[key]=options[key])}),this.base=this.select.handle,this.Init(element("div",this.attributes.wrapper)),this.base.parentNode.appendChild(this.handle),this.select.bind("dataChanged",function(){self.Refresh()}),this.select.bind("onChange",function(){if(self.isVisible){var item=self.handleInner.children[this.GetIndex()];self.Focused(item,!0),self.Marked(item,!0),self.SetPosition(item)}}),this.select.bind("onBlur",function(){setTimeout(function(){self.Show(!1,self.manageFocus)},100)}),this.select.handle.addEventListener("click",function(event){self.Show(!self.isVisible,self.manageFocus),event.stopPropagation(),event.stopImmediatePropagation(),event.preventDefault()}),this.Show(!1,self.manageFocus)}function CIntervalBox(parent,parameters){var _default,self=this,_value=0;CSimpleSelect.call(this,parent||null,parameters),this.attributes.wrapper.className+=" cinterval-box",void 0===parameters.align&&(this.attributes.content.className+=" center"),void 0!==parameters.contentStyle&&(this.attributes.content.className+=" "+parameters.contentStyle),this.Init(this.GenerateHandle()),this.name=parameters.name||"input",this.type="interval",this.parameters=parameters,void 0!==parameters.align&&(this.content.className+=" "+parameters.align,this.content.style.textAlign=parameters.align),this.max=parameters.max,this.min=parameters.min,this.interval=parameters.interval||1,void 0!==parameters.value?_value=void 0!==this.max&&parameters.value>this.max?this.max:void 0!==this.min&&parameters.value<this.min?this.min:parameters.value:void 0!==this.min?_value=this.min:void 0!==this.max&&(_value=this.max),_default=_value=parseInt(_value),this.SetValue=function(value){_value=parseInt(value),self.SetContent(_value),self.trigger("onChange",_value)},this.GetValue=function(){return _value},this.Next=function(){if(CSimpleSelect.prototype.Next.call(),void 0!==self.max){if(!(_value+self.interval<=self.max))return;_value+=self.interval}else _value+=self.interval;self.RefreshContent(),self.trigger("onNext",self.GetValue()),self.trigger("onChange",self.GetValue())},this.Previous=function(){if(CSimpleSelect.prototype.Next.call(),void 0!==self.min){if(!(_value-self.interval>=self.min))return;_value-=self.interval}else _value-=self.interval;self.RefreshContent(),self.trigger("onPrevious",self.GetValue()),self.trigger("onChange",self.GetValue())},this.RefreshContent=function(){this.SetContent(self.GetValue()),self.value=self.GetValue(),self.DisableElement(self.leftArrow,!1),self.DisableElement(self.rightArrow,!1),void 0!==self.min&&_value-self.interval<self.min&&self.DisableElement(self.leftArrow,!0),void 0!==self.max&&_value+self.interval>self.max&&self.DisableElement(self.rightArrow,!0)},this.IsChanged=function(){return _value!==_default},this.RefreshContent()}function PlayList(parent){CScrollList.call(this,parent),this.bcrumb=null,this.sbar=null,this.filterType=MEDIA_TYPE_NONE,this.filterText="",this.mtypes=[],this.path=[]}function getLanguageNameByCode(code){if(code.length)for(var i=0;i<iso639.length;i++)for(var j=0;j<iso639[i].code.length;j++)if(iso639[i].code[j]==code[0].toLowerCase())return[iso639[i].name,i];return null}function getIso639LangCode(langArr){var i,code="";for(i=0;i<langArr.length;i++)if(langArr[i]){code=langArr[i];break}return code}function CModal(parent){CPage.call(this,parent),this.name="CModal",this.baseClass="cmodal-main",this.showAttr="table",this.focusList=[],this.focusPos=0}function CModalBox(parent){CModal.call(this,parent),this.name="CModalBox",this.header=element("div",{className:"cmodal-header"}),this.content=element("div",{className:"cmodal-content"}),this.footer=element("div",{className:"cmodal-footer"})}function CModalHint(parent,data,time){if(data){CModalBox.call(this,parent),this.name="CModalHint";var self=this;this.SetHeader(),this.SetContent(data),this.SetFooter(),this.onHide=function(){self.Free()},this.Init(),this.handle.className=this.handle.className+" cModalHint",this.Show(!0),time&&(this.timer=setTimeout(function(){self.Show(!1)},time||5e3))}}function CModalAlert(parent,title,data,btnExitTitle,btnExitClick){if(data){CModalBox.call(this,parent),this.name="CModalAlert";var self=this;this.bpanel=new CButtonPanel,this.bpanel.Init(CMODAL_IMG_PATH),this.bpanel.Add(KEYS.EXIT,useNewIcons?"new/exit2.png":"ico_exit.png",btnExitTitle||"",function(){btnExitClick instanceof Function&&btnExitClick.call(self),self.Show(!1)}),this.SetHeader(title),this.SetContent(data),this.SetFooter(this.bpanel.handle),this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free()},this.EventHandler=function(e){eventPrepare(e,!0,"CModalAlert")&&self.bpanel.EventHandler(e)},this.Init(),this.Show(!0)}}function CModalConfirm(parent,title,data,btnExitTitle,btnExitClick,btnF2Title,btnF2Click){CModalAlert.call(this,parent,title,data,btnExitTitle,btnExitClick),this.name="CModalConfirm";var self=this;this.bpanel.Add(KEYS.OK,"ico_ok.png",btnF2Title,function(){self.Show(!1),btnF2Click instanceof Function&&(btnF2Click.call(self),btnF2Click=null)})}function CModalSelectLang(parent,label,text,data){CModalBox.call(this,parent),this.name="CModalSelectLang";var self=this;this.$interfaceLang=new CSelectBox(this,{data:languages,nameField:"label",style:"cselect-box-wide",events:{}}),this.$contentLang=new CSelectBox(this,{data:languages,nameField:"label",style:"cselect-box-wide",events:{}});var html=element("table",{className:"main maxw"},[element("tr",{},[element("td",{className:"name"},lang.interfaceLang),element("td",{className:"data"},this.$interfaceLang.parentNode)]),element("tr",{},[element("td",{className:"name"},lang.contentLang),element("td",{className:"data"},this.$contentLang.parentNode)])]),currentData=gSTB.LoadUserData("ex.ua.data.json");try{currentData=JSON.parse(currentData)}catch(err){echo('JSON.parse(LoadUserData("ex.ua.data.json")); -> ERROR ->'+err)}echo(currentData,'data JSON.parse(LoadUserData("ex.ua.data.json"))');for(var i=0;i<languages.length;i++)echo("languages[i].langVal === currentData.contentLang/currentData.interfaceLang=>"+languages[i].langVal+" === "+currentData.contentLang+" / "+currentData.interfaceLang),languages[i].langVal===currentData.contentLang&&this.$contentLang.SetIndex(i),languages[i].langVal===currentData.interfaceLang&&this.$interfaceLang.SetIndex(i);this.focusList=[[this.$interfaceLang],[this.$contentLang]],this.focusPos=0,this.FocusNext=function(event,manageVK){if(this.focusList.length>0){++this.focusPos>=this.focusList.length&&(this.focusPos=0);var el=this.focusList[this.focusPos][0];el.focus()}},this.FocusPrev=function(event,manageVK){if(this.focusList.length>0){--this.focusPos<0&&(this.focusPos=this.focusList.length-1);var el=this.focusList[this.focusPos][0];el.focus()}},this.saveNewLang=function(){echo("saveNewLang");var dataForSaving={contentLang:self.$contentLang.GetSelected().langVal,interfaceLang:self.$interfaceLang.GetSelected().langVal};gSTB.SaveUserData("ex.ua.data.json",JSON.stringify(dataForSaving)),window.location.reload()},this.bpanel=new CButtonPanel,this.bpanel.Init(CMODAL_IMG_PATH),this.bpanel.Add(KEYS.EXIT,useNewIcons?"new/exit2.png":"ico_exit.png",lang.cancel,function(){self.Show(!1)}),this.bpanel.Add(KEYS.OK,"ico_ok.png",lang.apply,function(){self.saveNewLang()}),this.SetHeader(label),this.SetContent(html),this.SetFooter(this.bpanel.handle),this.onShow=function(){self.focusList[self.focusPos][0].focus()},this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free()},this.EventHandler=function(event){if(echo("modal eventhandler"),eventPrepare(event,!0,"CModalAlert"))switch(event.code){case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:event.preventDefault();break;case KEYS.UP:self.FocusPrev(event,!1),event.preventDefault();break;case KEYS.DOWN:self.FocusNext(event,!1),event.preventDefault();break;case KEYS.LEFT:case KEYS.RIGHT:this.focusList[this.focusPos][0].EventHandler(event);break;case KEYS.VOLUME_DOWN:case KEYS.VOLUME_UP:event.preventDefault();break;default:self.bpanel.EventHandler(event)}},this.Init(),this.Show(!0)}function CModalAddDownload(parent,data){var html,self=this,prepareSize=function(size){return size>1073741824?Math.floor(size/1024/1024/1024*100)/100+" GB":size>1048576?Math.floor(size/1024/1024*100)/100+" MB":size>1024?Math.floor(size/1024*100)/100+" KB":size+" B"},refreshStorageInfo=function(){var usb,i;for(getStorageInfo(),i=0;i<STORAGE_INFO.length;i++)usb=STORAGE_INFO[i],0===usb.isReadOnly&&(usb.freeSizeStr=prepareSize(usb.freeSize),usb.sizeStr=prepareSize(usb.size),usb.id=i,usb.sizeIndicator=lang.freeSpace+" "+usb.freeSizeStr+lang.of+usb.sizeStr,allStorages.push(usb))},allStorages=[];CModalBox.call(this,parent),this.name="CModalAddDownload",refreshStorageInfo(),allStorages=allStorages.length>0?allStorages:[{id:-1,label:lang.noStorage}],this.$deviceSelect=new CSelectBox(this,{data:allStorages,nameField:"label",style:"cselect-box-wider",events:{onChange:function(){self.$sizeIndicator.innerText=this.GetSelected().sizeIndicator}}}),html=element("table",{className:"main maxw"},[element("tr",{},[element("td",{className:"name"},lang.downloadIn),element("td",{className:"data"},this.$deviceSelect.parentNode)]),element("tr",{},[element("td",{className:"name"}),this.$sizeIndicator=element("td",{className:"data"},self.$deviceSelect.GetSelected().sizeIndicator||lang.freeSpace+" 0")])]),this.saveNewLang=function(){var error=!1;data.forEach(function(item){var status=stbDownloadManager.AddJob(item.data.url,self.$deviceSelect.GetSelected().mountPath+"/"+item.data.name);echo("add new record"),echo("url:   "+item.data.url),echo("path:  "+self.$deviceSelect.GetSelected().mountPath),echo("status:"+status),status||(error=!0)}),self.Show(!1),new CModalHint(currCPage,error?lang.mediaDefaultError:lang.added,3e3)},this.bpanel=new CButtonPanel,this.bpanel.Init(CMODAL_IMG_PATH),this.bpanel.Add(KEYS.EXIT,useNewIcons?"new/exit2.png":"ico_exit.png",lang.cancel,function(){self.Show(!1)}),this.bpanel.Add(KEYS.OK,"ico_ok.png",lang.download,function(){self.saveNewLang()}),this.SetHeader(lang.download+" "+data.length+" "+lang.files),this.SetContent(html),this.SetFooter(this.bpanel.handle),this.onShow=function(){self.$deviceSelect.focus()},this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free()},this.EventHandler=function(event){if(echo("modal eventhandler"),eventPrepare(event,!0,"CModalAlert"))switch(event.code){case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:event.preventDefault();break;case KEYS.UP:case KEYS.DOWN:break;case KEYS.LEFT:case KEYS.RIGHT:this.$deviceSelect.EventHandler(event);break;case KEYS.VOLUME_DOWN:case KEYS.VOLUME_UP:event.preventDefault();break;default:self.bpanel.EventHandler(event)}},this.Init(),this.Show(!0)}function CButtonPanel(parent){CBase.call(this,parent),this.name="CButtonPanel",this.baseClass="cbpanel-main",this.path="",this.isActive=!0}function CBreadCrumb(parent){CBase.call(this,parent),this.name="CBreadCrumb",this.baseClass="cbcrumb-main",this.path="",this.litems=3,this.ritems=2}function mainEventListener(event){if(echo("mainEventListener"),eventPrepare(event,!1,"mainEventListener"))switch(event.code){case KEYS.MUTE:volume.toggleMute();break;case KEYS.VOLUME_UP:volume.currVol<100&&(volume.currVol=Number(volume.currVol)+volume.step),volume.setVol(volume.currVol);break;case KEYS.VOLUME_DOWN:volume.currVol>0&&(volume.currVol=Number(volume.currVol)-volume.step),volume.setVol(volume.currVol);break;case KEYS.POWER:standBy.toggleMode();break;default:currCPage&&currCPage.EventHandler instanceof Function?currCPage.EventHandler(event):event.preventDefault()}}function htmlListParser(html){var img,url,title,cat,add,i,cats=[];echo("new htmlListParser");try{if(html=html.split("include_0"),void 0===html[1]&&CSListManager.Current().handleInner.page_index>0)return CSListManager.Current().handleInner.page_length=CSListManager.Current().handleInner.page_index-1,void echo("this is end page. page_index="+CSListManager.Current().handleInner.page_index);html=html[1].split("</table>"),html=html[0].split("<td")}catch(error){return echo("WARNING! PARSER htmlListParser ERROR!"),echo("ERROR INFO: "+error),void ListPage.addListItems(cats)}for(i=1;i<html.length;i++)html[i].indexOf("iframe")>0||-1!==html[i].indexOf("/user/megogo")||-1!==html[i].indexOf("Нет доступа")||-1!==html[i].indexOf("No access")||(url=html[i].substring(html[i].indexOf("href='")+6,html[i].indexOf("'><")),img=html[i].indexOf("img src='")>0?html[i].substring(html[i].indexOf("img src='")+9,html[i].indexOf("' ",html[i].indexOf("img src='")+11)):"img/"+screen.height+"/ex_ua_noposter.png?100",title=html[i].substring(html[i].indexOf("<b>")+3,html[i].indexOf("</b>")),add=html[i].substring(html[i].indexOf("<small>")+7,html[i].indexOf("</small>")),img=img.replace("?100","?400"),cat=!(html[i].indexOf("Articles")<0&&html[i].indexOf("Статей")<0),("&nbsp;"===title||""===title||" "===title||null===title||void 0===title)&&(title="unnamed"),cats.push({url:"http://www.ex.ua"+url,img:img,title:unescape(title),cat:cat,add:add}));ListPage.addListItems(cats),echo("PARSER->ANSWER LENGTH="+cats.length)}function favsListParser(html){var i,cats=[];echo("favsListParser"),echo(html);try{html=html.data}catch(error){return echo("WARNING! PARSER favsListParser ERROR!"),echo("ERROR INFO: "+error),void ListPage.addListItems(cats)}for(i=0;i<html.length;i++)cats.push({url:html[i].info.url,img:html[i].info.img_src||html[i].info.img,img_src:html[i].info.img_src||html[i].info.img,title:html[i].info.title,cat:html[i].info.cat,addtime:html[i].info.add||html[i].info.addtime,type:html[i].info.type,add:html[i].info.add||html[i].info.addtime,favId:html[i].id});ListPage.addListItems(cats),echo("PARSER->ANSWER LENGTH="+cats.length)}function htmlSearchParser(html){var img,url,title,cat,add,i,cats=[];echo("new htmlSearchParser");try{html=html.split("class=panel"),html=html[1].split("</table>"),html=html[0].split("<td")}catch(error){return echo("WARNING! PARSER htmlSearchParser ERROR!"),echo("ERROR INFO: "+error),void new CModalAlert(ListPage,lang.searchIsOver,lang.noFiles,lang.backAction,function(){setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5)})}for(i=1;i<html.length;i++)echo("thru each descr"),html[i].indexOf("iframe")>0||-1!==html[i].indexOf("/user/megogo")||-1!==html[i].indexOf("Нет доступа")||-1!==html[i].indexOf("No access")?echo("continue"):(url=html[i].substring(html[i].indexOf("href='")+6,html[i].indexOf("'><")),img=html[i].indexOf("img src='")>0?html[i].substring(html[i].indexOf("img src='")+9,html[i].indexOf("' ",html[i].indexOf("img src='")+11)):"img/"+screen.height+"/ex_ua_noposter.png",title=html[i].substring(html[i].indexOf("<b>")+3,html[i].indexOf("</b>")),add=html[i].indexOf("modify_time")>0?html[i].substring(html[i].indexOf("<small>")+7,html[i].indexOf("<span")):html[i].substring(html[i].indexOf("<small>")+7,html[i].indexOf("</small>")),img=img.replace("?100","?400"),cat=!(html[i].indexOf("Articles")<0&&html[i].indexOf("Статей")<0),("&nbsp;"===title||""===title||" "===title||null===title||void 0===title)&&(title="unnamed"),cats.push({url:"http://www.ex.ua"+url,img:img,title:unescape(title),cat:cat,add:add}));echo("PARSER->ANSWER LENGTH="+cats.length),ListPage.addListItems(cats)}function onClickFunc(url,cat_id,cat_title,type){var data={url:url,real_cat_id:cat_id,title:cat_title,type:type};ListPage.start(data),MainPage.LastActComp=MainPage.typeList.Current().cat}function htmlObjectParser(html){var html_td,url,name,img_big,img_prev,sizeInBytes,resolution,i,j,ext,lightFiles,cats=[],start=html.indexOf("var player_list = '{"),end=html.indexOf("function init_player()",start),text=html.substring(start+19,end),lightItems=[];echo("htmlObjectParser new"),text?(text=('" }, '+text.replace("\" }';","")).trim(),lightFiles=text.split('" }, { "type": "video", "url": "'),lightFiles.shift()):lightFiles=[];try{html=html.split("class=list"),html=html[1].split("</table>"),html=html[0].split("<tr>")}catch(error){return echo("WARNING! PARSER htmlObjectParser ERROR!->50"),echo("ERROR INFO: "+error),void ListPage.addObjectItems(cats)}for(i=2;i<html.length;i++)for(html_td=html[i].split("<td"),url=html_td[2].substring(html_td[2].indexOf("href=")+6,html_td[2].indexOf("' title=")),sizeInBytes=html_td[4].substring(html_td[4].indexOf("<b>")+3,html_td[4].indexOf("</b>")),resolution=html_td[4].substring(html_td[4].indexOf("</a><br>")+8,html_td[4].indexOf("<p><span")),resolution.indexOf("x")<0&&(resolution=""),html_td[3].indexOf("img src")<0?(name=html_td[2].substring(html_td[2].indexOf("title=")+7,html_td[2].indexOf("' rel='nofollow'")),img_big="",img_prev=""):(name=html_td[2].substring(html_td[2].indexOf("title=")+7,html_td[2].indexOf("'>",html_td[2].indexOf("' title="))),img_big=html_td[3].substring(html_td[3].indexOf("href=")+6,html_td[3].indexOf("' id")),img_prev=img_big.replace("?100","?400")),cats.push({url:"http://www.ex.ua"+url,name:name,img_big:img_big,img_prev:img_prev,sizeInBytes:sizeInBytes,resolution:resolution}),url=url.replace("/get/",""),j=0;j<lightFiles.length;j++)if(-1!==lightFiles[j].indexOf(url)){lightItems.push({img_big:img_big,img_prev:img_prev,url:lightFiles[j],name:"light_"+name,sizeInBytes:"",img:"",resolution:""});break}cats=cats.concat(lightItems);var play={video:[],audio:[],images:[]};for(i=0;i<cats.length;i++)switch(ext=cats[i].name.split("."),cats[i].ext=ext[ext.length-1],echo("["+i+"]ext: "+cats[i].ext),cats[i].type="none",cats[i].ext.toLowerCase()){case"mpg":case"mov":case"mp4":case"avi":case"mkv":case"ts":case"vob":case"wmv":case"mts":case"m2t":case"m2v":case"divx":case"m2ts":case"m2p":case"tp":case"flv":case"mod":case"tod":case"asf":cats[i].type="video",play.video.push(cats[i]);break;case"mp3":case"wav":case"ac3":case"ape":case"ogg":case"oga":case"aiff":case"wv":case"tta":case"wma":case"flac":case"m4a":cats[i].type="audio",play.audio.push(cats[i]);break;case"jpg":case"jpeg":case"bmp":case"png":cats[i].type="image",play.images.push(cats[i])}ListPage.addObjectItems(play)}function htmlRadioParser(html){var current_radio,play={video:[],audio:[{}],images:[]},result=/<script>radio\('(.*?)'\);<\/script>/gim.exec(html);return echo("htmlRadioParser"),null===result?(echo("Found nothing for this radio"),void ListPage.addObjectItems(play)):(echo("result[1]="+result[1]),current_radio=CSListManager.src[0].Current(),play.audio[0].url=result[1],play.audio[0].name=current_radio.data.title,play.audio[0].img_big=current_radio.data.img_src,play.audio[0].img_prev=current_radio.data.img_src,void ListPage.addObjectItems(play))}function htmlActorsParser(html){var tmp,somelistItem,result=/pg_menu"([\s\S]*?pg_menu)/.exec(html),myRe=/href="(.*?)"><b>/g,counter=0,names=[lang.aboutActor,lang.catVideo,lang.catMusic,lang.catImages],current=CSListManager.Current(),data={title:"",img_src:"",addtime:"",url:"",iid:"",type:TYPE_BACK};for(echo("htmlActorsParser"),somelistItem=element("div",{className:"back"},".."),current.Add(somelistItem,{data:data,onclick:function(){return echo("onClick-> back"),setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5),!1}}),void 0!==result[1]&&(result[1]=result[1].replace(/<\!--<a href="\/view\/.*?<\/b><\/a>-->/gim,'<!--<a href="/view/BROKEN"><b>broken</b></a>-->'));null!==(tmp=myRe.exec(result[1]));){var title_text=names[counter],css_class="cat";data={type:WHAT_IS_THIS_TYPE,title:title_text,img_src:CSListManager.parentData.img_src,addtime:"",url:"http://www.ex.ua"+tmp[1],iid:counter},somelistItem=element("div",{className:css_class,innerHTML:title_text}),current.Add(somelistItem,{data:data,onclick:function(){return echo(this.data,"onClick->EnterData="),CSListManager.Open(this.data),!1}}),counter++}echo("current.handleInner.page_index"+current.handleInner.page_index),current.Activate(!0)}function htmlWhatIsThisParser(html,status){var source_html,currLen,curHandleInner,minStep,doc,current=CSListManager.Current().handleInner;return echo("htmlWhatIsThisParser"),MainPage.messageHint&&MainPage.messageHint.Show(!1),ListPage.Show(!0,MainPage),source_html=/include_0/im.exec(html),null!==source_html?(echo("current.data.type  = ORPHAN_FOLDER;"),current.data.type=ORPHAN_FOLDER,CSListManager.parentData.type=ORPHAN_FOLDER,CSListManager.Current().onFocus=function(current,previous){CSListManager.parent.onFocusAction(current,previous),currLen=CSListManager.Current().handleInner.childNodes.length,curHandleInner=CSListManager.Current().handleInner,minStep=CSListManager.parent.ItemsPerPage/4,echo("current.data.iid ="+current.data.iid+" currLen="+currLen),current.data.iid>currLen-minStep&&currLen>minStep&&curHandleInner.page_length>=curHandleInner.page_index&&(doc=CSListManager.Current().handleInner,echo("iid_scroll=100%=>ajax="+doc.data.url+"?p="+doc.page_index+"&per="+ListPage.ItemsPerPage),ajax("GET",doc.data.url+"?p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},CSListManager.Current().handleInner.onscroll=function(){var doc=CSListManager.Current().handleInner,scrollPosition=doc.scrollTop,pageSize=doc.scrollHeight-doc.clientHeight,percentageScrolled=Math.floor(scrollPosition/pageSize*100);echo("on scroll "),100===percentageScrolled&&doc.page_length>=doc.page_index&&(echo("scroll=100%=>ajax="+doc.data.url+"?p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage),ajax("GET",doc.data.url+"?p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},void htmlListParser(html)):null===source_html&&(source_html=/class=list/im.exec(html),null!==source_html)?(echo("current.data.type  = MEDIA_OBJECT;"),current.data.type=MEDIA_OBJECT,CSListManager.parentData.type=MEDIA_OBJECT,CSListManager.Current().onFocus=function(current,previous){ListPage.onFocusAction(current,previous)},ListPage.messageHint=new CModalHint(ListPage,lang.loading),void htmlObjectParser(html)):void(null===source_html&&new CModalAlert(ListPage,lang.loadingIsOver,lang.noFiles,lang.backAction,function(){setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5)}))}function htmlObjectInfoParser(html){return echo("htmlObjectInfoParser"),html=html.split("id='body_element'"),html=html[1].split("table"),null===html[1]?(echo("Found nothing for this object"),void new CModalAlert(ListPage,lang.searchIsOver,lang.noFiles,lang.backAction,function(){setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5)})):(html=html[2].split("td"),null===html[1]&&(html[1]=html[0]),html=html[1],html=html.split("href=").join("title="),void ListPage.Info.start("<div"+html+"div>"))}function checkForGiantImg(img_url,max_size,data_from_cache,data_from_browser){var timeout=null,xhr=new XMLHttpRequest;max_size||(max_size=5e5),xhr.onreadystatechange=function(){var file_size_head;4===xhr.readyState&&(clearTimeout(timeout),file_size_head=xhr.getResponseHeader("Content-Length"),echo(xhr.responseText,"AJAX :: head "+img_url+" (status:"+xhr.status+", length:"+xhr.responseText.length+") file length "+file_size_head),!file_size_head||file_size_head>max_size?(echo("I FOUND TOO BIG FILE -_- "),void 0!==data_from_browser&&(data_from_browser.src="img/"+screen.height+"/ex_ua_noposter.png?100"),data_from_cache.img_src="img/"+screen.height+"/ex_ua_noposter.png?100"):(void 0!==data_from_browser&&(data_from_browser.src=img_url),data_from_cache.img_src=img_url))},xhr.open("head",img_url,!0),xhr.send(),timeout=setTimeout(function(){xhr.abort(),echo("ABORT on timeout","AJAX :: head "+img_url)},6e4)}var DEBUG=!0,DEBUG_NAME="",DEBUG_SERVER="",EMULATION=!1,PATH_MODE_WEB=!1,PATH_ROOT="/home/web/",PATH_SYSTEM=PATH_ROOT+"system/",WINDOW_WIDTH=screen.width,WINDOW_HEIGHT=screen.height,URL_PARAMS={},proxy;["http:","https:"].indexOf(document.location.protocol)>=0&&(PATH_MODE_WEB=!0,
Array.prototype.slice.call(document.getElementsByTagName("script")).forEach(function(tag){if(tag.src){var path=tag.src.split("/"),head=path.pop();0===head.indexOf("init.js")&&(PATH_SYSTEM=path.join("/")+"/",path.pop(),PATH_ROOT=path.join("/")+"/")}})),document.location.search&&document.location.search.substring(1).split("&").forEach(function(part){part=part.split("="),2===part.length&&(URL_PARAMS[part[0]]=decodeURIComponent(part[1]))}),window.parent&&window.parent.gSTB&&(window.dvbManager=window.parent.dvbManager,window.epgManager=window.parent.epgManager,window.gSTB=window.parent.gSTB,window.pvrManager=window.parent.pvrManager,window.stbDownloadManager=window.parent.stbDownloadManager,window.stbStorage=window.parent.stbStorage,window.stbUpdate=window.parent.stbUpdate,window.stbUPnP=window.parent.stbUPnP,window.stbWebWindow=window.parent.stbWebWindow,window.stbWindowMgr=window.parent.stbWindowMgr,window.timeShift=window.parent.timeShift),void 0===window.gSTB?(DEBUG=EMULATION=!0,DEBUG_SERVER=DEBUG_SERVER||localStorage.getItem("DEBUG_SERVER"),DEBUG_NAME=DEBUG_NAME||localStorage.getItem("DEBUG_NAME"),WINDOW_WIDTH=parseInt(URL_PARAMS.width,10)||window.outerWidth,WINDOW_HEIGHT=parseInt(URL_PARAMS.height,10)||window.outerHeight,document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'gstb.js"></script>\n'),document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+':8800/file/client.js"></script>\n'),document.write('<script type="text/javascript">if ( window.proxyClient ) {proxy = new proxyClient();if ( DEBUG_NAME && DEBUG_SERVER ) proxy.init({name:"'+DEBUG_NAME+'", host:"'+DEBUG_SERVER+'"}); }</script>\n'),window.addEventListener("load",function(){document.body.style.backgroundColor="black"})):("function"==typeof gSTB.SetNativeStringMode&&gSTB.SetNativeStringMode(!0),function(){var vars=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["debug","debug_name","debug_server"]})));!vars.errMsg&&vars.result&&(DEBUG="1"===vars.result.debug,DEBUG&&!URL_PARAMS.nodebug&&(document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),DEBUG_NAME=DEBUG_NAME||vars.result.debug_name,DEBUG_SERVER=DEBUG_SERVER||vars.result.debug_server,DEBUG_NAME&&DEBUG_SERVER&&document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+":8000/target/target-script-min.js#"+DEBUG_NAME+'"></script>\n')))}());var TYPE_NONE=0,ROOT_VIDEO=1,ROOT_AUDIO=2,ROOT_IMAGE=3,ROOT_GLOBAL_SEARCH=4,ROOT_NEWS=5,ROOT_FAVS=6,GLOBAL_SEARCH_FOLDER=8,MEDIA_OBJECT=10,MEDIA_FOLDER=11,RADIO_OBJECT=12,ACTORS_FOLDER=13,TYPE_BACK=14,MEDIA_TYPE_VIDEO=15,MEDIA_TYPE_AUDIO=16,MEDIA_TYPE_IMAGE=17,GLOBAL_SEARCH_REFRESH=18,LOCAL_SEARCH_REFRESH=19,LOCAL_SEARCH_ROOT=20,WHAT_IS_THIS_TYPE=21,ORPHAN_FOLDER=22,MEDIA_TYPE_NONE=0,NORMAL_MODE=0,LSEARCH_MODE=1,languages=[{label:"English",id:0,langVal:"en"},{label:"Русский",id:1,langVal:"ru"},{label:"Українська",id:2,langVal:"uk"}],deviceProxy="",currCPage,exURL="http://www.ex.ua",favApiUrl="http://api.magapps.net/v1/",type_focus_timer=0,cat_focus_timer=0,rightMenuTextLength=200,ServiceMenu={},pauseData={curTime:0,fileLength:0,paused:!1,audioTrack:0},MAX_READABLE_IMAGE_WEIGHT=5e5,oldSystemType=!0,useNewIcons=!1,typeInfo,mainPageMenu,volume={currVol:50,step:5,muted:!1,timerId:null,timeout:2e3},content={ru:{},en:{},uk:{}};gSTB.SetScreenSaverImplUrl instanceof Function&&(oldSystemType=!1),content.uk.typeInfo=[],content.uk.typeInfo[ROOT_VIDEO]={icon:"media_ico_vid.png",urlStart:"http://www.ex.ua/",urlEnd:"?r=80934"},content.uk.typeInfo[ROOT_AUDIO]={icon:"media_ico_aud.png",urlStart:"http://www.ex.ua/",urlEnd:"?r=80935"},content.uk.typeInfo[ROOT_IMAGE]={icon:"media_ico_img.png",urlStart:"http://www.ex.ua/",urlEnd:"?r=80936"},content.uk.typeInfo[MEDIA_OBJECT]={icon:"ico_folder_files.png"},content.uk.typeInfo[MEDIA_FOLDER]={icon:"media_ico_fld.png"},content.uk.typeInfo[ROOT_GLOBAL_SEARCH]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?s="},content.uk.typeInfo[GLOBAL_SEARCH_FOLDER]={icon:"media_ico_fld.png"},content.uk.typeInfo[LOCAL_SEARCH_ROOT]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?original_id=",urlEnd:"&s="},content.uk.typeInfo[GLOBAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.uk.typeInfo[LOCAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.uk.typeInfo[RADIO_OBJECT]={icon:"media_ico_str.png",urlStart:"http://radio.ex.ua:8000/",id:"6996870"},content.uk.typeInfo[ACTORS_FOLDER]={icon:"media_ico_fld.png",id:"artist"},content.uk.typeInfo[WHAT_IS_THIS_TYPE]={icon:"media_ico_fld.png"},content.uk.typeInfo[ORPHAN_FOLDER]={icon:"media_ico_fld.png"},content.uk.typeInfo[ROOT_NEWS]={icon:"media_ico_fld.png"},content.uk.typeInfo[MEDIA_TYPE_VIDEO]={icon:"media_ico_vid.png"},content.uk.typeInfo[MEDIA_TYPE_AUDIO]={icon:"media_ico_aud.png"},content.uk.typeInfo[MEDIA_TYPE_IMAGE]={icon:"media_ico_img.png"},content.en.typeInfo=[],content.en.typeInfo[ROOT_VIDEO]={icon:"media_ico_vid.png",urlStart:"http://www.ex.ua/view/",urlEnd:"?r=80925,81708"},content.en.typeInfo[ROOT_AUDIO]={icon:"media_ico_aud.png",urlStart:"http://www.ex.ua/view/",urlEnd:"?r=80926,81709"},content.en.typeInfo[ROOT_IMAGE]={icon:"media_ico_img.png",urlStart:"http://www.ex.ua/view/",urlEnd:"?r=80927,81710"},content.en.typeInfo[MEDIA_OBJECT]={icon:"ico_folder_files.png"},content.en.typeInfo[MEDIA_FOLDER]={icon:"media_ico_fld.png"},content.en.typeInfo[ROOT_GLOBAL_SEARCH]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?s="},content.en.typeInfo[GLOBAL_SEARCH_FOLDER]={icon:"media_ico_fld.png"},content.en.typeInfo[LOCAL_SEARCH_ROOT]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?original_id=",urlEnd:"&s="},content.en.typeInfo[GLOBAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.en.typeInfo[LOCAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.en.typeInfo[RADIO_OBJECT]={icon:"media_ico_str.png",urlStart:"http://radio.ex.ua:8000/",id:"6996870"},content.en.typeInfo[ACTORS_FOLDER]={icon:"media_ico_fld.png",id:"artist"},content.en.typeInfo[WHAT_IS_THIS_TYPE]={icon:"media_ico_fld.png"},content.en.typeInfo[ORPHAN_FOLDER]={icon:"media_ico_fld.png"},content.en.typeInfo[ROOT_NEWS]={icon:"media_ico_fld.png"},content.en.typeInfo[MEDIA_TYPE_VIDEO]={icon:"media_ico_vid.png"},content.en.typeInfo[MEDIA_TYPE_AUDIO]={icon:"media_ico_aud.png"},content.en.typeInfo[MEDIA_TYPE_IMAGE]={icon:"media_ico_img.png"},content.ru.typeInfo=[],content.ru.typeInfo[ROOT_VIDEO]={icon:"media_ico_vid.png",urlStart:"http://www.ex.ua/ru/video/",urlEnd:"?r=23775"},content.ru.typeInfo[ROOT_AUDIO]={icon:"media_ico_aud.png",urlStart:"http://www.ex.ua/view/",urlEnd:"?r=23776"},content.ru.typeInfo[ROOT_IMAGE]={icon:"media_ico_img.png",urlStart:"http://www.ex.ua/view/",urlEnd:"?r=23777"},content.ru.typeInfo[ROOT_FAVS]={icon:"media_ico_fav.png",urlStart:"",urlEnd:""},content.ru.typeInfo[MEDIA_OBJECT]={icon:"ico_folder_files.png"},content.ru.typeInfo[MEDIA_FOLDER]={icon:"media_ico_fld.png"},content.ru.typeInfo[ROOT_GLOBAL_SEARCH]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?s="},content.ru.typeInfo[GLOBAL_SEARCH_FOLDER]={icon:"media_ico_fld.png"},content.ru.typeInfo[LOCAL_SEARCH_ROOT]={icon:"ico_search3.png",urlStart:"http://www.ex.ua/search?original_id=",urlEnd:"&s="},content.ru.typeInfo[GLOBAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.ru.typeInfo[LOCAL_SEARCH_REFRESH]={icon:"ico_search3.png"},content.ru.typeInfo[RADIO_OBJECT]={icon:"media_ico_str.png",urlStart:"http://radio.ex.ua:8000/",id:"6996870"},content.ru.typeInfo[ACTORS_FOLDER]={icon:"media_ico_fld.png",id:"artist"},content.ru.typeInfo[WHAT_IS_THIS_TYPE]={icon:"media_ico_fld.png"},content.ru.typeInfo[ORPHAN_FOLDER]={icon:"media_ico_fld.png"},content.ru.typeInfo[ROOT_NEWS]={icon:"media_ico_fld.png"},content.ru.typeInfo[MEDIA_TYPE_VIDEO]={icon:"media_ico_vid.png"},content.ru.typeInfo[MEDIA_TYPE_AUDIO]={icon:"media_ico_aud.png"},content.ru.typeInfo[MEDIA_TYPE_IMAGE]={icon:"media_ico_img.png"},content.uk.mainPageMenu={video:[{type:ROOT_VIDEO,title:"Закордонне кіно",url:"82470",rss:"82470",newsCache:[]},{type:ROOT_VIDEO,title:"Наше кіно",url:"82473",rss:"82473",newsCache:[]},{type:ROOT_VIDEO,title:"Документальне",url:"82476",rss:"82476",newsCache:[]},{type:ROOT_VIDEO,title:"Серіали",url:"82480",rss:"82480",newsCache:[]},{type:ROOT_VIDEO,title:"Трейлери",url:"82483",rss:"82483",newsCache:[]},{type:ROOT_VIDEO,title:"Мультфільми",url:"82484",rss:"82484",newsCache:[]},{type:ROOT_VIDEO,title:"Аніме",url:"82488",rss:"82488",newsCache:[]},{type:ROOT_VIDEO,title:"Кліпи",url:"82489",rss:"82489",newsCache:[]},{type:ROOT_VIDEO,title:"Концерти",url:"82490",rss:"82490",newsCache:[]},{type:ROOT_VIDEO,title:"Шоу та передачі",url:"82493",rss:"82493",newsCache:[]},{type:ROOT_VIDEO,title:"Уроки та Тренінги",url:"82495",rss:"82495",newsCache:[]},{type:ROOT_VIDEO,title:"Спорт",url:"82496",rss:"82496",newsCache:[]},{type:ROOT_VIDEO,title:"ExTube",url:"82499",rss:"82499",newsCache:[]},{type:ROOT_VIDEO,title:"Театр",url:"82508",rss:"82508",newsCache:[]},{type:ROOT_VIDEO,title:"Проповіді",url:"371167",rss:"371167",newsCache:[]},{type:ROOT_VIDEO,title:"Рекламні ролики",url:"371168",rss:"371168",newsCache:[]}],audio:[{type:ROOT_AUDIO,title:"Музика",url:"82515",rss:"82515",newsCache:[]},{type:ROOT_AUDIO,title:"OST",url:"82518",rss:"82518",newsCache:[]},{type:ROOT_AUDIO,title:"Аудіокниги",url:"82521",rss:"82521",newsCache:[]},{type:ROOT_AUDIO,title:"Рінгтони",url:"82522",rss:"82522",newsCache:[]},{type:ROOT_AUDIO,title:"Уроки та Тренінги",url:"84516",rss:"84516",newsCache:[]},{type:ROOT_AUDIO,title:"Аудіоспектаклі",url:"38502573",rss:"38502573",newsCache:[]},{type:ROOT_AUDIO,title:"Аудіодоріжки",url:"38502830",rss:"38502830",newsCache:[]},{type:ROOT_AUDIO,title:"Проповіді, Молитви",url:"38503040",rss:"38503040",newsCache:[]},{type:ROOT_AUDIO,title:"Гумор",url:"38503215",rss:"38503215",newsCache:[]},{type:ROOT_AUDIO,title:"Караоке",url:"38506848",rss:"38506848",newsCache:[]},{type:ROOT_AUDIO,title:"Аудiоказки",url:"38507143",rss:"38507143",newsCache:[]}],images:[{type:ROOT_IMAGE,title:"Арт",url:"82524",rss:"82524",newsCache:[]},{type:ROOT_IMAGE,title:"Приватні фото",url:"82527",rss:"82527",newsCache:[]},{type:ROOT_IMAGE,title:"Фон на робочий стіл",url:"82528",rss:"82528",newsCache:[]},{type:ROOT_IMAGE,title:"Кліпарт",url:"82531",rss:"82531",newsCache:[]},{type:ROOT_IMAGE,title:"Приколи",url:"82533",rss:"82533",newsCache:[]},{type:ROOT_IMAGE,title:"Скріншоти",url:"82535",rss:"82535",newsCache:[]},{type:ROOT_IMAGE,title:"Постери",url:"38503396",rss:"38503396",newsCache:[]}],favorites:[{type:ROOT_FAVS,title:"Відео",url:0,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Аудіо",url:1,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Зображення",url:2,rss:"",newsCache:[]}]},content.en.mainPageMenu={video:[{type:ROOT_VIDEO,title:"Movies",url:"82316",rss:"82316",newsCache:[]},{type:ROOT_VIDEO,title:"Documentaries",url:"82318",rss:"82318",newsCache:[]},{type:ROOT_VIDEO,title:"Series",url:"82325",rss:"82325",newsCache:[]},{type:ROOT_VIDEO,title:"Trailers",url:"82326",rss:"82326",newsCache:[]},{type:ROOT_VIDEO,title:"Cartoons",url:"82329",rss:"82329",newsCache:[]},{type:ROOT_VIDEO,title:"Anime",url:"82331",rss:"82331",newsCache:[]},{type:ROOT_VIDEO,title:"Clips",url:"82333",rss:"82333",newsCache:[]},{type:ROOT_VIDEO,title:"Live Concerts",url:"82335",rss:"82335",newsCache:[]},{type:ROOT_VIDEO,title:"Shows and Live",url:"82339",rss:"82339",newsCache:[]},{type:ROOT_VIDEO,title:"Lessons and Trainings",url:"82343",rss:"82343",newsCache:[]},{type:ROOT_VIDEO,title:"Sport",url:"82348",rss:"82348",newsCache:[]},{type:ROOT_VIDEO,title:"ExTube",url:"82350",rss:"82350",newsCache:[]},{type:ROOT_VIDEO,title:"Theatre and Musicals",url:"82354",rss:"82354",newsCache:[]},{type:ROOT_VIDEO,title:"Sermon",url:"371177",rss:"371177",newsCache:[]},{type:ROOT_VIDEO,title:"Commercials",url:"371172",rss:"371172",newsCache:[]}],audio:[{type:ROOT_AUDIO,title:"Music",url:"82379",rss:"82379",newsCache:[]},{type:ROOT_AUDIO,title:"OST",url:"82380",rss:"82380",newsCache:[]},{type:ROOT_AUDIO,title:"Audio Books",url:"82381",rss:"82381",newsCache:[]},{type:ROOT_AUDIO,title:"Ringtones",url:"82383",rss:"82383",newsCache:[]},{type:ROOT_AUDIO,title:"Lessons and Trainings",url:"84518",rss:"84518",newsCache:[]}],images:[{type:ROOT_IMAGE,title:"Art",url:"82391",rss:"82391",newsCache:[]},{type:ROOT_IMAGE,title:"Personal",url:"82393",rss:"82393",newsCache:[]},{type:ROOT_IMAGE,title:"Wallpapers",url:"82394",rss:"82394",newsCache:[]},{type:ROOT_IMAGE,title:"Jokes and Funny pictures",url:"82398",rss:"82398",newsCache:[]},{type:ROOT_IMAGE,title:"Screenshots",url:"82403",rss:"82403",newsCache:[]}],favorites:[{type:ROOT_FAVS,title:"Video",url:0,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Audio",url:1,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Images",url:2,rss:"",newsCache:[]}]},content.ru.mainPageMenu={video:[{type:ROOT_VIDEO,title:"Зарубежное",url:"foreign",rss:"2",newsCache:[]},{type:ROOT_VIDEO,title:"Наше",url:"our",rss:"70538",newsCache:[]},{type:ROOT_VIDEO,title:"Зарубежные сериалы",url:"foreign_series",rss:"1988",newsCache:[]},{type:ROOT_VIDEO,title:"Наши сериалы",url:"our_series",rss:"422546",newsCache:[]},{type:ROOT_VIDEO,title:"Мультфильмы",url:"cartoon",rss:"1989",newsCache:[]},{type:ROOT_VIDEO,title:"Аниме",url:"anime",rss:"23786",newsCache:[]},{type:ROOT_VIDEO,title:"Документальное",url:"documentary",rss:"1987",newsCache:[]},{type:ROOT_VIDEO,title:"Трейлеры",url:"trailer",rss:"1990",newsCache:[]},{type:ROOT_VIDEO,title:"Клипы",url:"clip",rss:"1991",newsCache:[]},{type:ROOT_VIDEO,title:"Концерты",url:"concert",rss:"70533",newsCache:[]},{type:ROOT_VIDEO,title:"Шоу и Передачи",url:"show",rss:"28713",newsCache:[]},{type:ROOT_VIDEO,title:"Уроки и Тренинги",url:"training",rss:"28714",newsCache:[]},{type:ROOT_VIDEO,title:"Спорт",url:"sport",rss:"69663",newsCache:[]},{type:ROOT_VIDEO,title:"Короткие видео ролики, приколы",url:"short",rss:"23785",newsCache:[]},{type:ROOT_VIDEO,title:"Театр",url:"theater",rss:"70665",newsCache:[]},{type:ROOT_VIDEO,title:"Проповеди",url:"sermon",rss:"371146",newsCache:[]},{type:ROOT_VIDEO,title:"Рекламные ролики",url:"commercial",rss:"371152",newsCache:[]},{type:ROOT_VIDEO,title:"Для мобильных устройств",url:"mobile",rss:"607160",newsCache:[]},{type:ROOT_VIDEO,title:"Артисты",url:"artist",rss:"7513588",newsCache:[]},{type:MEDIA_FOLDER,title:"3D",url:"http://www.ex.ua/73427589?r=23775",rss:"73427589",newsCache:[]},{type:MEDIA_FOLDER,title:"UHDTV (4K)",url:"http://www.ex.ua/78103603?r=23775",rss:"78103603",newsCache:[]}],audio:[{type:ROOT_AUDIO,title:"Музыка",url:"3",rss:"3",newsCache:[]},{type:ROOT_AUDIO,title:"OST",url:"71793",rss:"71793",newsCache:[]},{type:ROOT_AUDIO,title:"Аудиокниги",url:"3454",rss:"3454",newsCache:[]},{type:ROOT_AUDIO,title:"Рингтоны",url:"28712",rss:"28712",newsCache:[]},{type:ROOT_AUDIO,title:"Уроки и Тренинги",url:"84513",rss:"84513",newsCache:[]},{type:ROOT_AUDIO,title:"Караоке",url:"707499",rss:"707499",newsCache:[]},{type:ROOT_AUDIO,title:"Радио",url:"6996870",rss:"6996870",newsCache:[]},{type:ROOT_AUDIO,title:"Аудиоспектакли",url:"38494793",rss:"38494793",newsCache:[]},{type:ROOT_AUDIO,title:"Проповеди",url:"38495531",rss:"38495531",newsCache:[]},{type:ROOT_AUDIO,title:"Юмор",url:"38495711",rss:"38495711",newsCache:[]},{type:ROOT_AUDIO,title:"Аудиосказки",url:"39032910",rss:"39032910",newsCache:[]}],images:[{type:ROOT_IMAGE,title:"Арт",url:"28739",rss:"28739",newsCache:[]},{type:ROOT_IMAGE,title:"Частные фото",url:"904",rss:"904",newsCache:[]},{type:ROOT_IMAGE,title:"Обои на рабочий стол",url:"16984",rss:"16984",newsCache:[]},{type:ROOT_IMAGE,title:"Клипарт",url:"28726",rss:"28726",newsCache:[]},{type:ROOT_IMAGE,title:"Приколы",url:"28727",rss:"28727",newsCache:[]},{type:ROOT_IMAGE,title:"Скриншоты",url:"31049",rss:"31049",newsCache:[]},{type:ROOT_IMAGE,title:"Архитектура и города",url:"371136",rss:"371136",newsCache:[]},{type:ROOT_IMAGE,title:"Fashion",url:"508267",rss:"508267",newsCache:[]}],favorites:[{type:ROOT_FAVS,title:"Видео",url:0,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Аудио",url:1,rss:"",newsCache:[]},{type:ROOT_FAVS,title:"Изображения",url:2,rss:"",newsCache:[]}]};var iso639=[{code:["eng","en"],name:"English"},{code:["rus","ru"],name:"Russian"},{code:["ukr","uk"],name:"Ukrainian"},{code:["bel","be"],name:"Belarusian"},{code:["fre","fra","fr"],name:"French"},{code:["ger","deu","de"],name:"German"},{code:["ita","it"],name:"Italian"},{code:["spa","es"],name:"Spanish"},{code:["por","pt"],name:"Portuguese"},{code:["swe","sv"],name:"Swedish"},{code:["nor","no"],name:"Norwegian"},{code:["dut","nld","nl"],name:"Dutch"},{code:["srp","scc","sr"],name:"Serbian"},{code:["slv","sl"],name:"Slovenian"},{code:["hrv","hr","scr"],name:"Croatian"},{code:["alb","sqi","sq"],name:"Albanian"},{code:["jpn","ja"],name:"Japanese"},{code:["chi","zho","zh"],name:"Chinese"},{code:["kor","ko"],name:"Korean"},{code:["vie","vi"],name:"Vietnamese"},{code:["lav","lv"],name:"Latvian"},{code:["lit","lt"],name:"Lithuanian"},{code:["est","et"],name:"Estonian"},{code:["fin","fi"],name:"Finnish"},{code:["hun","hu"],name:"Hungarian"},{code:["cze","ces","cs"],name:"Czech"},{code:["slo","slk","sk"],name:"Slovak"},{code:["bul","bg"],name:"Bulgarian"},{code:["pol","pl"],name:"Polish"},{code:["rum","ron","ro"],name:"Romanian"},{code:["gre","ell","el"],name:"Greek"},{code:["heb","he"],name:"Hebrew"},{code:["tur","tr"],name:"Turkish"},{code:["dan","da"],name:"Danish"},{code:["ice","isl","is"],name:"Icelandic"},{code:["hin","hi"],name:"Hindi"},{code:["ben","bn"],name:"Bengali"},{code:["ara","ar"],name:"Arabic"},{code:["arm","hye","hy"],name:"Armenian"},{code:["geo","kat","ka"],name:"Georgian"},{code:["aze","az"],name:"Azerbaijani"},{code:["bak","ba"],name:"Bashkir"},{code:["baq","eus","eu"],name:"Basque"},{code:["bos","bs"],name:"Bosnian"},{code:["bua"],name:"Buriat"},{code:["bur","mya","my"],name:"Burmese"},{code:["che","ce"],name:"Chechen"},{code:["wel","cym","cy"],name:"Welsh"},{code:["dzo","dz"],name:"Dzongkha"},{code:["epo","eo"],name:"Esperanto"},{code:["per","fa"],name:"Persian"},{code:["gle","ga"],name:"Irish"},{code:["guj","gu"],name:"Gujarati"},{code:["ind","id"],name:"Indonesian"},{code:["ira"],name:"Iranian"},{code:["kas","ks"],name:"Kashmiri"},{code:["kaz","kk"],name:"Kazakh"},{code:["kbd"],name:"Kabardian"},{code:["kom","kv"],name:"Komi"},{code:["krl"],name:"Karelian"},{code:["kur","ku"],name:"Kurdish"},{code:["mar","mr"],name:"Marathi"},{code:["mac","mkd","mk"],name:"Macedonian"},{code:["nep","ne"],name:"Nepali"},{code:["oss","os"],name:"Ossetian"},{code:["sah"],name:"Yakut"},{code:["som","so"],name:"Somali"},{code:["tam","ta"],name:"Tamil"},{code:["tat","tt"],name:"Tatar"},{code:["tel","te"],name:"Telugu"},{code:["tgk","tg"],name:"Tajik"},{code:["tha","th"],name:"Thai"},{code:["tuk","tk"],name:"Turkmen"},{code:["udm"],name:"Udmurt"},{code:["urd","ur"],name:"Urdu"},{code:["uzb","uz"],name:"Uzbek"},{code:["xal"],name:"Kalmyk"},{code:["tib","bod","bo"],name:"Tibetan"},{code:["yid","yi"],name:"Yiddish"},{code:["nothing","nothing"],name:"Keine Audiospur"}],KEYS={POWER:2085,MUTE:2192,MIC:2032,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUM0:48,MENU:122,BACK:8,CHANNEL_PREV:1009,CHANNEL_NEXT:9,EXIT:27,REFRESH:116,UP:38,DOWN:40,LEFT:37,RIGHT:39,OK:13,PAGE_UP:33,PAGE_DOWN:34,VOLUME_UP:107,VOLUME_DOWN:109,F1:112,F2:113,F3:114,F4:115,SET:120,TV:121,PHONE:119,WEB:123,REWIND:2066,FORWARD:2070,PLAY_PAUSE:2082,STOP:2083,RECORD:2087,INFO:2089,FRAME:117,APP:2076,USB_UNMOUNTED:2081,USB_MOUNTED:2080,DELETE:46};void 0===window.echo&&(window.echo=function(data,title){});var Events={bind:function(event,callback){if(this._events||(this._events={}),"object"==typeof event)for(var name in event)this.bind(name,event[name]);else"string"==typeof event&&"function"==typeof callback&&(void 0===this._events[event]&&(this._events[event]=[]),this._events[event].push(callback))},trigger:function(event,data){var result,results=[],self=this;return void 0!==event&&void 0!==this._events&&void 0!==this._events[event]&&this._events[event].forEach(function(ev){result=ev.call(self,data),void 0!=result&&results.push(result)}),results},unbind:function(event){delete this._events[event]},inject:function(obj){"function"==typeof obj?extend(obj.prototype,this):"object"==typeof obj&&extend(obj,this)}};CBase.prototype.SetParent=function(parent){parent instanceof CBase&&(this.parent=parent)},CBase.prototype.Init=function(handle){if(handle&&handle.nodeName){this.handle=handle,this.baseClass&&-1===handle.className.indexOf(this.baseClass)?this.handleInner=this.handle.appendChild(element("div",{className:this.baseClass})):this.handleInner=this.handle;var self=this;this.handle.addEventListener("click",function(event){self.onClick instanceof Function&&self.onClick()===!1&&event.stopPropagation()}),this.onInit instanceof Function&&this.onInit()}},CBase.prototype.Activate=function(active){this.isActive=active!==!1,this.isActive?(this.onActivate instanceof Function&&this.onActivate(),this.parent&&(this.parent.activeChild&&this.parent.activeChild!==this&&this.parent.activeChild.Activate(!1),this.parent.activeChild=this)):(this.onDeactivate instanceof Function&&this.onDeactivate(),this.parent&&(this.parent.activeChild=null))},CBase.prototype.Show=function(visible,manageFocus){var success=!1;return this.handle&&(this.isVisible=visible!==!1,this.isVisible?this.handle.style.display!==this.showAttr&&(this.prevFocus=document.activeElement,manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display=this.showAttr,manageFocus!==!1&&this.handle.focus(),this.onShow instanceof Function&&this.onShow(),success=!0):"none"!==this.handle.style.display&&(manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display="none",manageFocus!==!1&&this.prevFocus&&this.prevFocus.focus(),this.onHide instanceof Function&&this.onHide(),this.isActive&&this.Activate(!1),success=!0)),success},CBase.prototype.EventHandler=null,CBase.prototype.onInit=null,CBase.prototype.onShow=null,CBase.prototype.onHide=null,CBase.prototype.onActivate=null,CBase.prototype.onDeactivate=null,CBase.prototype.onClick=function(){return this.Activate(!0),!0},CPage.prototype=Object.create(CBase.prototype),CPage.prototype.constructor=CPage,CPage.prototype.Show=function(visible,previous){visible===!1?(this.activeChild&&this.activeChild.Activate(!1),CBase.prototype.Show.call(this,!1,!0,!0),currCPage=this.previous||ServiceMenu,this.previous=null,currCPage&&currCPage!==this&&CBase.prototype.Show.call(currCPage,!0,!0,!0)):(currCPage&&currCPage!==this&&(currCPage.activeChild&&currCPage.activeChild.Activate(!1),CBase.prototype.Show.call(currCPage,!1,!0,!0)),CBase.prototype.Show.call(this,!0,!0,!0),this.previous=previous||null,currCPage=this)},CPage.prototype.onClick=function(){return!1},CScrollList.prototype=Object.create(CBase.prototype),CScrollList.prototype.constructor=CScrollList,CScrollList.prototype.Add=function(body,attrs){attrs=attrs||{};var item=this.handleInner.appendChild(element("a",this.defaultParams,body));attrs.hidden&&this.Hidden(item,!0),attrs.marked&&this.Marked(item,!0),attrs.disabled&&this.Disabled(item,!0),attrs.focused&&this.Focused(item,!0);for(var name in attrs)item[name]=attrs[name];return item},CScrollList.prototype.Clear=function(){this.handleInner.innerHTML=null,this.activeItem=null,this.states={}},CScrollList.prototype.Reset=function(item){item&&item.nodeName&&(this.Hidden(item,this.defaultParams.hidden),this.Marked(item,this.defaultParams.marked),this.Disabled(item,this.defaultParams.disabled),this.Focused(item,this.defaultParams.focused),item!==this.activeItem||item.focused||(this.activeItem=null))},CScrollList.prototype.DeleteAll=function(items){var self=this,curPos=null;items instanceof Array&&items.length>0&&(null!==document.activeElement&&document.activeElement.parentNode===this.handleInner&&document.activeElement.blur(),-1===items.indexOf(this.Current())?curPos=this.Current():(curPos=this.Next({marked:!1,hidden:!1,disabled:!1}),(null===curPos||curPos===this.Current())&&(curPos=this.Next({marked:!1,hidden:!1,disabled:!1},!0))),items.forEach(function(item){self.Delete(item)}),null!==curPos&&this.Focused(curPos,!0))},CScrollList.prototype.Delete=function(item){if(item&&item.nodeName&&item.parentNode===this.handleInner){for(var name in this.states){var index=this.states[name].indexOf(item);-1!==index&&this.states[name].splice(index,1)}item===this.activeItem&&(this.activeItem=null),this.handleInner.removeChild(item)}},CScrollList.prototype.Current=function(){return this.activeItem},CScrollList.prototype.Length=function(){return this.handleInner.children.length},CScrollList.prototype.SetPosition=function(item,makeFocused,manageFocus){var index,page;makeFocused&&(void 0===manageFocus&&(manageFocus=this.manageFocus),this.Focused(item||this.FindOne(),!0,manageFocus)),null!==this.activeItem&&(this.itemHeight&&this.itemsPerPage||(0===this.itemsPerPage&&null!==this.handleInner.firstChild&&(this.itemsPerPage=Math.round(this.handleInner.offsetHeight/this.handleInner.firstChild.offsetHeight)),0===this.itemHeight&&null!==this.handleInner.firstChild&&(this.itemHeight=this.handleInner.firstChild.offsetHeight)),index=this.activeItem.offsetTop/this.itemHeight,page=Math.floor(index/this.itemsPerPage),1===this.scrollMode?this.handleInner.scrollTop=(index-Math.floor((this.itemsPerPage-1)/2))*this.itemHeight:2===this.scrollMode&&(this.handleInner.scrollTop=this.itemsPerPage*this.itemHeight*page))},CScrollList.prototype.SetState=function(item,option,state){if(state=Boolean(state),item[option]!==state){this.states[option]||(this.states[option]=[]);var index=this.states[option].indexOf(item);state?-1===index&&this.states[option].push(item):-1!==index&&this.states[option].splice(index,1);var oldVal=item[option];return item[option]=state,state?item.className+=" "+option+" ":item.className=item.className.replace(" "+option+" ",""),this.onStateChange instanceof Function&&this.onStateChange(item,option,oldVal,state),!0}return!1},CScrollList.prototype.Hidden=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"hidden",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Marked=function(item,state){return state=Boolean(state),item&&item.nodeName&&!item.disabled&&!item.hidden?this.SetState(item,"marked",state):!1},CScrollList.prototype.Disabled=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"disabled",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Focused=function(item,state,manageFocus){var changed=!1,prevent=!1;return state=state!==!1,item&&item.nodeName&&!item.disabled&&!item.hidden&&state!==item.focused&&(state?(item!==this.activeItem&&(this.onFocus instanceof Function&&(prevent=this.onFocus(item,this.activeItem)),prevent||(changed=this.SetState(item,"focused",state),this.Focused(this.activeItem,!1,manageFocus),this.activeItem=item)),manageFocus!==!1&&this.activeItem.focus()):(changed=this.SetState(item,"focused",state),manageFocus!==!1&&this.activeItem.blur(),this.activeItem=null)),changed},CScrollList.prototype.Activate=function(state,manageFocus){return CBase.prototype.Activate.call(this,state),this.isActive?(this.activeItem=this.activeItem||this.FindOne(),null===this.activeItem?!1:(this.SetState(this.activeItem,"focused",!0),manageFocus!==!1&&this.activeItem.focus(),!0)):void(this.activeItem&&this.activeItem.blur())},CScrollList.prototype.Each=function(callback){Array.prototype.forEach.call(this.handleInner.children,callback)},CScrollList.prototype.Find=function(filter,limit,reverse){var match,found=[],items=this.handleInner.children,itlen=items.length,citem=null;filter=filter||this.defaultFilter;for(var i=0;itlen>i;i++){citem=items[reverse?itlen-i-1:i],match=!0;for(var attr in filter)match=match&&citem[attr]===filter[attr];if(match&&(found.push(citem),limit&&found.length>=limit))break}return found},CScrollList.prototype.FindOne=function(filter,reverse){return this.Find(filter,1,reverse).pop()||null},CScrollList.prototype.Next=function(filter,reverse,nskip){var match,suitable=this.activeItem,pointer=this.activeItem,skipcount=0;if(nskip=nskip||0,pointer)for(filter=filter||this.defaultFilter;pointer=reverse?pointer.previousSibling:pointer.nextSibling;){match=!0;for(var attr in filter)match=match&&pointer[attr]===filter[attr];if(pointer.hidden||skipcount++,match&&(suitable=pointer,0===nskip||nskip>0&&skipcount>=nskip))return suitable}return suitable},CScrollList.prototype.EventHandler=function(event,filter){0===this.itemsPerPage&&null!==this.handleInner.firstChild&&(this.itemsPerPage=Math.round(this.handleInner.offsetHeight/this.handleInner.firstChild.offsetHeight)),0===this.itemHeight&&null!==this.handleInner.firstChild&&(this.itemHeight=this.handleInner.firstChild.offsetHeight);var found=null;switch(event.code){case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:found=this.Next(filter,event.code!==KEYS.PAGE_DOWN,this.itemsPerPage),this.handleInner.scrollTop=this.handleInner.scrollTop+(event.code===KEYS.PAGE_UP?-1:1)*this.itemsPerPage*this.itemHeight;break;case KEYS.LEFT:case KEYS.RIGHT:found=this.FindOne(filter,event.code===KEYS.RIGHT);break;case KEYS.UP:case KEYS.DOWN:found=this.Next(filter,event.code===KEYS.UP),echo(this.handleInner.scrollTop,"this.handleInner.scrollTop"),echo(this.activeItem.offsetTop,"this.activeItem.offsetTop"),1===this.scrollMode?this.handleInner.scrollTop=this.activeItem.offsetTop-(this.itemsPerPage-1)/2*this.itemHeight+(event.code===KEYS.UP?-1:1)*this.itemHeight:2===this.scrollMode&&(event.code===KEYS.UP?this.activeItem.offsetTop===this.handleInner.scrollTop&&(this.handleInner.scrollTop=this.handleInner.scrollTop-this.itemsPerPage*this.itemHeight):this.activeItem.offsetTop-this.handleInner.scrollTop===(this.itemsPerPage-1)*this.itemHeight&&(this.handleInner.scrollTop=this.handleInner.scrollTop+this.itemsPerPage*this.itemHeight)),echo(this.handleInner.scrollTop,"this.handleInner.scrollTop");break;case KEYS.OK:return this.activeItem&&this.activeItem.onclick(),void event.preventDefault();default:return}event.preventDefault(),this.Focused(found||this.FindOne(filter),!0)},CScrollList.prototype.onFocus=null,CScrollList.prototype.onStateChange=null,CSearchBar.prototype=Object.create(CBase.prototype),CSearchBar.prototype.constructor=CSearchBar,CSearchBar.prototype.Init=function(path,handle,hint){this.path=path,this.hint=hint||"";var self=this,func=function(){self.Activate(!self.isActive),event.stopPropagation()};CBase.prototype.Init.call(this,handle),this.items.hint=element("input",{type:"text",className:"hint maxw",value:this.hint}),this.items.text=element("input",{type:"text",className:"text maxw",onkeydown:function(event){self.EventHandler(event)}}),this.items.span=element("div",{className:"csbar-item span"}),this.items.icon=element("div",{className:"csbar-item icon",onclick:func},element("img",{className:"",src:this.path+"/ico_search2.png"})),this.items.button=element("div",{className:"csbar-item icon",onclick:func},element("img",{className:"",src:this.path+"/ico_f4.png"})),this.items.input=element("div",{className:"csbar-item stext"},[this.items.hint,this.items.text]),elchild(this.handleInner,[this.items.input,this.items.span,this.items.icon,this.items.button])},CSearchBar.prototype.ShowInput=function(visible,manageFocus){visible=visible!==!1,visible||(this.items.text.blur(),gSTB.HideVirtualKeyboard(),manageFocus!==!1&&this.prevFocus&&this.prevFocus.focus()),this.items.input.style.display=visible?"table-cell":"none",this.items.span.style.display=visible?"none":"table-cell",visible&&(this.prevFocus=document.activeElement,this.items.text.focus(),gSTB.ShowVirtualKeyboard());
},CSearchBar.prototype.Reset=function(){this.Activate(!1),this.items.text.value=this.items.hint.value=this.hint=this.filter="",this.items.icon.lastChild.src=this.path+"/ico_search2.png"},CSearchBar.prototype.onSearch=null,CSearchBar.prototype.onHint=null,CSearchBar.prototype.SetHint=function(hint){hint=hint||this.items.text.value||this.hint,hint&&(this.items.hint.value=hint)},CSearchBar.prototype.EventHandler=function(event){switch(echo("CSearchBar.prototype.EventHandler event.keyCode="+event.keyCode+" event.code"+event.code),event.keyCode){case KEYS.LEFT:case KEYS.RIGHT:case KEYS.UP:case KEYS.DOWN:break;case KEYS.EXIT:this.Activate(!1),event.stopPropagation();break;case KEYS.F4:this.Activate(!this.isActive),event.stopPropagation();break;case KEYS.OK:this.Activate(!1),this.onSearch instanceof Function&&this.onSearch(this.items.text.value),this.items.icon.firstChild.src=this.items.text.value?this.path+"/ico_filter.png":this.path+"/ico_search2.png",event.stopPropagation();break;default:if(echo("prototype.default"),this.items.hint.value=""===this.items.text.value?this.hint:"",this.onHint instanceof Function){this.items.hint.value==this.hint&&this.SetHint(" "),this.timer&&clearTimeout(this.timer);var self=this;this.timer=setTimeout(function(){self.onHint.call(self,self.items.text.value)},300)}}},CSearchBar.prototype.Activate=function(active,manageFocus){active||this.ShowInput(!1,manageFocus),CBase.prototype.Activate.call(this,active),active&&this.ShowInput(!0,manageFocus)},CGroupMenu.prototype=Object.create(CBase.prototype),CGroupMenu.prototype.constructor=CGroupMenu,CGroupMenu.prototype.Init=function(handle){CBase.prototype.Init.call(this,handle),this.handle.onclick=function(event){event.stopPropagation()}},CGroupMenu.prototype.GetGroup=function(gid){for(var i=0,items=this.handleInner.children,length=items.length;length>i;i++)if(items[i].gid===gid)return items[i];return!1},CGroupMenu.prototype.AddGroup=function(gid,title,options){var self=this;if(gid&&!this.GetGroup(gid)){var aleft,aright,hlist=element("div",{className:"cslist-main"}),group=element("table",{gid:gid,slist:new CScrollList,options:options||{}},[element("tr",{className:"title"},[element("td",{className:"side",onclick:function(){self.Switch(self.Next({hidden:!1},!0),!0)}},aleft=element("p")),element("td",null,title),element("td",{className:"side",onclick:function(){self.Switch(self.Next({hidden:!1}),!0)}},aright=element("p"))]),element("tr",{className:"ilist"},element("td",{colSpan:3},hlist))]);return group.options.hidden=group.options.hidden?!0:!1,group.slist.Init(hlist),group.aleft=aleft,group.aright=aright,elchild(this.handleInner,group),group}return!1},CGroupMenu.prototype.Hidden=function(group,state){group&&group.nodeName&&(group.options.hidden=state)},CGroupMenu.prototype.AddItem=function(group,iid,body,options){return options=options||{},options.iid=iid,group.options.onclick&&!options.onclick&&(options.onclick=group.options.onclick),options.icon&&(body=element("div",{className:"short"},body),body.style.backgroundImage='url("'+options.icon+'")',body.style.backgroundPosition="right",body.style.backgroundRepeat="no-repeat"),group.slist.Add(body,options)},CGroupMenu.prototype.ApplyArrows=function(){this.activeGroup.aright.className=this.Next({hidden:!1})?"active":"",this.activeGroup.aleft.className=this.Next({hidden:!1},!0)?"active":""},CGroupMenu.prototype.Switch=function(group,activate){return group&&group.gid&&group.nodeName?(this.activeGroup&&(this.activeGroup.slist.Activate(!1),this.activeGroup.style.display="none"),this.activeGroup=group,this.activeGroup.style.display="table",activate&&(this.activeGroup.slist.Activate(),this.autoFocus&&Array.isArray(this.activeGroup.slist.states.marked)&&this.activeGroup.slist.Focused(this.activeGroup.slist.states.marked[0],!0)),this.ApplyArrows(),!0):!1},CGroupMenu.prototype.Activate=function(active,setFocus){var status=!1;return null!==this.activeGroup&&(status=this.activeGroup.slist.Activate(active,setFocus)),this.autoFocus&&Array.isArray(this.activeGroup.slist.states.marked)&&this.activeGroup.slist.Focused(this.activeGroup.slist.states.marked[0],!0),status},CGroupMenu.prototype.Next=function(filter,reverse){var match,pointer=this.activeGroup;if(pointer)for(;pointer=reverse?pointer.previousSibling:pointer.nextSibling;){match=!0;for(var attr in filter)filter.hasOwnProperty(attr)&&(match=match&&pointer.options[attr]===filter[attr]);if(match)return pointer}return null},CGroupMenu.prototype.EventHandler=function(event){switch(event.code){case KEYS.LEFT:this.Switch(this.Next({hidden:!1},!0),!0);break;case KEYS.RIGHT:this.Switch(this.Next({hidden:!1}),!0);break;default:this.activeGroup.slist.EventHandler(event)}},CSimpleSelect.prototype=Object.create(CBase.prototype),CSimpleSelect.prototype.constructor=CSimpleSelect,CSimpleSelect.prototype.GenerateHandle=function(){var wrapper,content_wrapper,self=this;return void 0!==this.parameters.content&&"div"===this.parameters.content.tagName.toLowerCase()?(this.content=this.parameters.content,this.content.parentNode.removeChild(this.content),void 0!==this.content.className&&(this.attributes.content.className+=" "+this.content.className),this.content=element("div",this.attributes.content,this.content||"")):(void 0!==this.parameters.content&&"div"!==this.parameters.content.tagName.toLowerCase()&&(this.content=this.parameters.content),this.content=element("div",this.attributes.content,this.content||"")),content_wrapper=element("div",this.attributes.content_wrapper,[this.content,this.hint=element("div",this.attributes.hint)]),this.parameters.leftArrow?(this.leftArrow=this.parameters.leftArrow,this.leftArrow.parentNode.removeChild(this.leftArrow),this.leftArrow=element("div",this.attributes.left_arrow,this.leftArrow)):this.leftArrow=element("div",this.attributes.left_arrow,this.leftArrow||element("p")),this.parameters.rightArrow?(this.rightArrow=this.parameters.rightArrow,this.rightArrow.parentNode.removeChild(this.rightArrow),this.rightArrow=element("div",this.attributes.right_arrow,this.rightArrow)):this.rightArrow=element("div",this.attributes.right_arrow,this.rightArrow||element("p")),wrapper=element("div",this.attributes.wrapper,element("div",{className:"content-wrapper",onfocus:function(){}},[this.leftArrow,content_wrapper,this.rightArrow])),wrapper.className+=" "+this.style,void 0!==this.parameters.width&&(wrapper.style.width=this.parameters.width),this.leftArrow.onclick=function(event){self.disabled||(self.Previous(),event.stopPropagation(),event.preventDefault())},this.rightArrow.onclick=function(event){self.disabled||(self.Next(),event.stopPropagation(),event.preventDefault())},wrapper},CSimpleSelect.prototype.onInit=function(){var self=this;elchild(this.parentNode,this.handle),this.handle.component=this,this.handle.onblur=function(){self.trigger("onBlur")},this.handle.onfocus=function(){self.trigger("onFocus")}},CSimpleSelect.prototype.EventHandler=function(event){if(echo("event.code=>"+event.code),eventPrepare(event,!0,"CSimpleSelect"),this.disabled!==!0)switch(event.stopped=!0,echo("event.code=>"+event.code),event.code){case KEYS.LEFT:this.Previous();break;case KEYS.RIGHT:this.Next();break;default:event.stopped=!1}},CSimpleSelect.prototype.SetContent=function(content){this.content.innerHTML="",this.content.innerHTML=content},CSimpleSelect.prototype.DisableElement=function(element,disable){disable===!0?-1===element.className.indexOf("disabled")&&(element.className+=" disabled"):element.className=element.className.replace(" disabled","")},CSimpleSelect.prototype.SetHint=function(hint){this.hint.innerHTML=hint},CSimpleSelect.prototype.Next=function(){},CSimpleSelect.prototype.Previous=function(){this.autocomplete=""},CSimpleSelect.prototype.focus=function(){this.handle.focus()},CSimpleSelect.prototype.blur=function(){this.handle.blur()},CSimpleSelect.prototype.IsFocused=function(){return document.activeElement===this.handle},CSimpleSelect.prototype.Disable=function(disable){this.DisableElement(this.handle,this.disabled=disable===!0)},Events.inject(CSimpleSelect),CSelectBox.prototype=Object.create(CSimpleSelect.prototype),CSelectBox.prototype.constructor=CSelectBox,CSelectDropdown.prototype=Object.create(CScrollList.prototype),CSelectDropdown.prototype.constructor=CSelectDropdown,CSelectDropdown.parameters=["scrollMode","select","container"],CSelectDropdown.prototype.Refresh=function(){var el,i,self=this,data=this.select.GetData();for(this.Clear(),i=0;i<data.length,el=data[i];i++)"object"==typeof el&&(el=el[this.select.GetNameField()]),this.Add(element("div",extend(this.attributes.element,{innerHTML:el})),{onclick:function(){self.select.SetIndex(self.activeItem.index),self.Marked(self.activeItem,!0),self.Show(!1,self.manageFocus)},index:i})},CSelectDropdown.prototype.onShow=function(){this.UpdateGeometry();var item=this.handleInner.children[this.select.GetIndex()];this.Focused(item,!0),this.Marked(item,!0),this.SetPosition(item)},CSelectDropdown.prototype.UpdateGeometry=function(){var containerRect,inputRect=this.base.getBoundingClientRect(),top=this.base.offsetTop+inputRect.height,height=WINDOW_HEIGHT;void 0!==this.container&&(containerRect=this.container.getBoundingClientRect(),height=containerRect.top+containerRect.height),inputRect.top+this.itemHeight*this.itemsPerPage>height&&(top=this.base.offsetTop-this.itemHeight*this.itemsPerPage),1===this.scrollMode&&(top-=this.itemHeight*Math.abs(Math.floor(this.itemsPerPage/2*-1))),this.handle.style.top=top+"px",this.handle.style.left=this.base.offsetLeft+"px",this.handle.style.width=inputRect.width-2*parseInt(document.defaultView.getComputedStyle(this.handle,"")["border-left-width"])+"px"},Events.inject(CSelectDropdown),CIntervalBox.prototype=Object.create(CSimpleSelect.prototype),CIntervalBox.prototype.constructor=CIntervalBox;var stbEvent={},MediaPlayer=new CPage,environment=function(){var environment,prevPlayerVolume,varList=["lang_audiotracks","audio_initial_volume","graphicres","subtitles_on","lang_subtitles","language","subtitles_on","hdmi_event_delay"],query='{"varList":["'+varList.join('","')+'"]}';try{environment=JSON.parse(gSTB.GetEnv(query)).result,environment.lang_audiotracks||(environment.lang_audiotracks=1),"true"===environment.subtitles_on?environment.lang_subtitles||(environment.lang_subtitles=0):environment.lang_subtitles=-1,environment.subtitles_on="true"===environment.subtitles_on,prevPlayerVolume=gSTB.GetVolume(),prevPlayerVolume>=0&&100>=prevPlayerVolume?volume.currVol=prevPlayerVolume:environment.audio_initial_volume&&environment.audio_initial_volume>=0&&environment.audio_initial_volume<=100&&(volume.currVol=environment.audio_initial_volume)}catch(e){echo(e,"Environment load")}return environment.hdmi_event_delay=Number(environment.hdmi_event_delay),environment}();MediaPlayer.EVENT_START=1,MediaPlayer.EVENT_STOP=2,MediaPlayer.EVENT_PAUSE=3,MediaPlayer.EVENT_PROGRESS=4,MediaPlayer.EVENT_ERROR=5,MediaPlayer.EVENT_OK=6,MediaPlayer.EVENT_EXIT=7,MediaPlayer.onInit=function(){for(var self=this,defLang="",i=0;i<iso639.length;i++){for(var j=0;j<iso639[i].code.length;j++)if(iso639[i].code[j]===environment.language){defLang=iso639[i].code[0];break}if(""!==defLang)break}gSTB.InitPlayer(),gSTB.SetVideoControl(0),gSTB.SetVideoState(0),gSTB.SetTopWin(0),gSTB.SetWinMode(0,0),gSTB.SetWinMode(1,0),gSTB.SetMode(0),gSTB.SetWinAlphaLevel(0,255),gSTB.SetWinAlphaLevel(1,255),gSTB.SetPIG(1,0,0,0),gSTB.SetAudioLangs(""===environment.lang_audiotracks?"":iso639[environment.lang_audiotracks].code[0],defLang),gSTB.SetSubtitleLangs(""===environment.lang_subtitles||-1===environment.lang_subtitles?"":iso639[environment.lang_subtitles].code[0],defLang),this.countError=0,this.pos=0,this.posTime="",this.posMod=0,this.posIntervals=[0,10,20],this.curTime=0,this.totalTime=0,this.infoFlag=!0,this.coord={},this.playNow=!1,this.posModFlag=!1,this.fullScreen=!0,this.type=null,this.obj=null,this.timer={},this.slideOn=0,this.currLang="en",this.subscribers={},this.SubscribersReset(),this.playListShow=!1,this.subtitles_on=environment.subtitles_on,this.aspects=[{name:"fit",img:"/aspect_fit.png",mode:16},{name:"big",img:"/aspect_big.png",mode:64},{name:"opt",img:"/aspect_opt.png",mode:80},{name:"exp",img:"/aspect_exp.png",mode:0}],this.activeAspect=0,this.progress={480:620,576:620,720:1180,1080:1770},this.$PlayerTotalTime=playerTotalTime,this.$PlayerCurrentTime=playerCurrentTime,this.$PlayerBar=playerBar,this.$PlayerTitle=playerTitle,this.$PlayerBufferBar=playerBufferBar,this.$PlayerProgressBar=playerProgressBar,this.$PlayerHeader=playerHeader,this.$PlayerFooter=playerFooter,this.$PlayerList=playerListBox,this.$SlideContainer=slideContainer,$playerHideplist.innerHTML=lang.playerBtnF2sh,playerHeaderSetting.innerHTML=lang.playerBtnMenu,playerHideplayer.innerHTML=lang.playerBtnInfo,playlistPrev.innerHTML=lang.playlistPrev,playlistNext.innerHTML=lang.playlistNext,this.handle.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.EventHandler({code:KEYS.INFO}),!1}),playerHeaderSetting.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.ModalMenu.Show(!0),!1}),$playerHideplist.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.togglePlaylist(),!1}),playerHideplayer.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.EventHandler({code:KEYS.INFO}),!1}),playerExit.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.exit(),!1}),playerPause.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.playPause(),!1}),playerREW.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.setPos(-1),!1}),playerFFWD.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.setPos(1),!1}),playlistPrev.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.EventHandler({code:KEYS.PAGE_UP}),!1}),playlistNext.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),MediaPlayer.EventHandler({code:KEYS.PAGE_DOWN}),!1}),this.Menu=new CGroupMenu,this.Menu.Init(this.handle.querySelector(".mbfade_sidebar")),this.init=[],this.init[MEDIA_TYPE_VIDEO]=function(refresh){self.$PlayerTotalTime.innerHTML="00:00:00",self.$PlayerCurrentTime.innerHTML="00:00:00",self.$PlayerBufferBar.style.width="0px",self.$PlayerProgressBar.style.width="0px",refresh||(self.$PlayerBar.style.display="block",self.$PlayerCurrentTime.style.display="block",self.$PlayerBufferBar.style.display="none",self.$PlayerProgressBar.style.display="block",self.handle.querySelector("#playerPause").style.display="block",self.handle.querySelector("#playerREW").style.display="block",self.handle.querySelector("#playerFFWD").style.display="block",self.handle.querySelector("#playerTotalTime").style.display="block",self.handle.querySelector("#playerCurrentTime").style.display="block",self.handle.querySelector("#playerSlash").style.display="block"),self.curTime=0,self.totalTime=0,self.posIntervals=[0,10,20]},this.init[MEDIA_TYPE_AUDIO]=function(refresh){self.init[MEDIA_TYPE_VIDEO](refresh),self.$SlideContainer.style.visibility="visible"},this.init[MEDIA_TYPE_IMAGE]=function(){self.$PlayerBar.style.display="none",self.$PlayerCurrentTime.style.display="none",self.$PlayerBufferBar.style.display="none",self.$PlayerProgressBar.style.display="none",self.handle.querySelector("#playerPause").style.display="none",self.handle.querySelector("#playerREW").style.display="none",self.handle.querySelector("#playerFFWD").style.display="none",self.handle.querySelector("#playerTotalTime").style.display="none",self.handle.querySelector("#playerCurrentTime").style.display="none",self.handle.querySelector("#playerSlash").style.display="none"},this.PlayList=new PlayList(this),this.PlayList.Init(this.handle.querySelector("#playerList")),stbEvent.onEvent=this.event,this.ModalMenu=new CModal(this),this.ModalMenu.Menu=new CGroupMenu(this.ModalMenu),this.ModalMenu.Menu.Init(this.handle.querySelector("div.cgmenu-main")),this.ModalMenu.onShow=function(){this.Menu.Activate()},this.ModalMenu.Init(element("div",{className:"cmodal-menu"},this.ModalMenu.Menu.handle)),this.ModalMenu.EventHandler=function(event){switch(event.code){case KEYS.EXIT:case KEYS.MENU:self.ModalMenu.Show(!1);break;default:self.ModalMenu.Menu.EventHandler(event)}},this.ModalMenu.handle.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),self.ModalMenu.Show(!1),console.log("ModalMenu-clicked"),!1}),this.ModalMenu.Menu.gaudio=this.ModalMenu.Menu.AddGroup("gaudio",lang.mediaMenuGroups.gaudio,{onclick:function(){return(self.ModalMenu.Menu.gaudio.slist.states.marked||[]).forEach(function(item){item.self.Marked(item,!1)}),self.ModalMenu.Menu.gaudio.slist.Marked(this,!0),self.ModalMenu.Show(!1),gSTB.SetAudioPID(this.data),clearTimeout(self.timer.audio),self.handle.querySelector("#audioText").innerHTML=this.innerHTML,self.handle.querySelector("#cright").style.display="block",self.timer.audio=setTimeout(function(){MediaPlayer.handle.querySelector("#cright").style.display="none"},5e3),!1}}),this.ModalMenu.Menu.gsubtitle=this.ModalMenu.Menu.AddGroup("gsubtitle",lang.mediaMenuGroups.gsubtitle,{onclick:function(){return(self.ModalMenu.Menu.gsubtitle.slist.states.marked||[]).forEach(function(item){item.self.Marked(item,!1)}),self.ModalMenu.Menu.gsubtitle.slist.Marked(this,!0),"OFF"===this.data?gSTB.SetSubtitles(!1):(gSTB.SetSubtitles(!0),gSTB.SetSubtitlePID(this.data)),self.ModalMenu.Show(!1),!1}}),this.ModalMenu.Menu.g3d=this.ModalMenu.Menu.AddGroup("g3d",lang.mediaMenuGroups.g3d,{onclick:function(){return(self.ModalMenu.Menu.g3d.slist.states.marked||[]).forEach(function(item){item.self.Marked(item,!1)}),self.ModalMenu.Menu.g3d.slist.Marked(this,!0),self.ModalMenu.Show(!1),gSTB.Set3DConversionMode&&gSTB.Set3DConversionMode(this.data),!1}}),this.ModalMenu.Menu.g3d.i1=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.g3d,1,lang.mediaInfoMenu3D+" 1",{data:0}),this.ModalMenu.Menu.g3d.i2=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.g3d,2,lang.mediaInfoMenu3D+" 2",{data:1}),this.ModalMenu.Menu.g3d.i3=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.g3d,3,lang.mediaInfoMenu3D+" 3",{data:2}),this.ModalMenu.Menu.g3d.i4=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.g3d,4,lang.mediaInfoMenu3D+" 4",{data:3}),this.ModalMenu.Menu.gslideOn=this.ModalMenu.Menu.AddGroup("gslideOn",lang.mediaMenuGroups.gslideOn,{onclick:function(){return(self.ModalMenu.Menu.gslideOn.slist.states.marked||[]).forEach(function(item){item.self.Marked(item,!1)}),self.ModalMenu.Menu.gslideOn.slist.Marked(this,!0),self.ModalMenu.Show(!1),self.slideOn=this.data,clearTimeout(self.timer.slideShow),self.slideOn>0&&(self.timer.slideShow=window.setTimeout(function(){MediaPlayer.list.length>1&&MediaPlayer.fullScreen&&self.PlayList.playIndex+1<self.list.length&&(self.PlayList.playIndex++,self.PlayList.Focused(self.PlayList.handle.children[self.PlayList.playIndex],!0),self.prepare(self.list[self.PlayList.activeItem.data.index],!0),ListPage.Preview.setPosition(self.obj))},1e3*self.slideOn)),!1}}),this.ModalMenu.Menu.gslideOn.ioff=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,1,lang.mediaMenuOff,{data:0,marked:!0}),this.ModalMenu.Menu.gslideOn.i3=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,2,"3 "+lang.timeSeconds,{data:3}),this.ModalMenu.Menu.gslideOn.i5=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,2,"5 "+lang.timeSeconds,{data:5}),this.ModalMenu.Menu.gslideOn.i10=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,2,"10 "+lang.timeSeconds,{data:10}),this.ModalMenu.Menu.gslideOn.i20=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,2,"20 "+lang.timeSeconds,{data:20}),this.ModalMenu.Menu.gslideOn.i30=this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gslideOn,2,"30 "+lang.timeSeconds,{data:30}),echo("MediaPlayer.modalInit = {};"),this.modalInit={},this.modalInit[MEDIA_TYPE_IMAGE]=function(){self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.gslideOn,!1),self.ModalMenu.Menu.Switch(self.ModalMenu.Menu.gslideOn,!1)},this.modalInit[MEDIA_TYPE_AUDIO]=function(){self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.gaudio,!1),self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.gsubtitle,!1),self.ModalMenu.Menu.Switch(self.ModalMenu.Menu.gaudio,!1)},this.modalInit[MEDIA_TYPE_VIDEO]=function(){self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.gaudio,!1),self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.gsubtitle,!1),self.ModalMenu.Menu.Switch(self.ModalMenu.Menu.gaudio,!1),self.ModalMenu.Menu.Hidden(self.ModalMenu.Menu.g3d,!1),(self.ModalMenu.Menu.g3d.slist.states.marked||[]).forEach(function(item){item.self.Marked(item,!1)}),self.ModalMenu.Menu.g3d.slist.Marked(self.ModalMenu.Menu.g3d.i1,!0)},this.ModalMenu.Menu.Switch(this.ModalMenu.Menu.gaudio)},MediaPlayer.togglePlaylist=function(){return this.list.length>1&&(this.playListShow&&this.infoFlag?(this.playListShow=!1,$playerHideplist.innerHTML=lang.playerBtnF2sh,this.$PlayerList.style.display="none"):(this.playListShow=!0,$playerHideplist.innerHTML=lang.playerBtnF2hd,this.showInfo(!0),this.$PlayerList.style.display="block",this.PlayList.Refresh(),this.PlayList.SetPosition(this.PlayList.Current(),!0,!0))),!1},MediaPlayer.EventHandler=function(e){switch(echo("MediaPlayer.EventHandler"),e.code){case KEYS.UP:case KEYS.DOWN:this.playListShow&&this.infoFlag&&this.PlayList.EventHandler(e);break;case KEYS.PAGE_DOWN:this.list.length>1&&this.PlayList.playIndex+1<this.list.length&&(this.PlayList.Focused(this.PlayList.handle.children[this.PlayList.playIndex+1],!0),this.PlayList.Open(this.PlayList.activeItem.data)),e.preventDefault();break;case KEYS.PAGE_UP:this.list.length>1&&this.PlayList.playIndex>0&&(this.PlayList.Focused(this.PlayList.handle.children[this.PlayList.playIndex-1],!0),this.PlayList.Open(this.PlayList.activeItem.data)),e.preventDefault();break;case KEYS.OK:if(echo("MediaPlayer.KEYS.OK;"),this.posModFlag){clearTimeout(this.timer.setPos),echo(MediaPlayer.pos,"set pos:"),gSTB.SetPosTime(this.pos),this.pos=0,this.posTime="",this.posMod=0,this.$PlayerCurrentTime.className="time_cur",gSTB.Continue(),this.posModFlag=!1,clearTimeout(this.timer.showInfo),this.timer.showInfo=setTimeout(function(){echo("showInfo_1"),MediaPlayer.showInfo(!1)},5),e.preventDefault();break}if(this.playListShow&&this.infoFlag){this.PlayList.EventHandler(e),echo("MediaPlayer.PlayList.EventHandler(e);");break}ListPage.subscribeEvents[this.EVENT_OK].call(ListPage);break;case KEYS.INFO:this.showInfo();break;case KEYS.MENU:this.ModalMenu.Show(!0);break;case KEYS.BACK:case KEYS.EXIT:this.exit();break;case KEYS.FRAME:this.aspect();break;case KEYS.PLAY_PAUSE:this.playPause();break;case KEYS.STOP:this.exit();break;case KEYS.LEFT:case KEYS.REWIND:(this.type===MEDIA_TYPE_VIDEO||this.type===MEDIA_TYPE_AUDIO)&&this.setPos(-1);break;case KEYS.RIGHT:case KEYS.FORWARD:(this.type===MEDIA_TYPE_VIDEO||this.type===MEDIA_TYPE_AUDIO)&&this.setPos(1);break;case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:break;case KEYS.NUM0:this.setPosTime("0");break;case KEYS.NUM1:this.setPosTime("1");break;case KEYS.NUM2:this.setPosTime("2");break;case KEYS.NUM3:this.setPosTime("3");break;case KEYS.NUM4:this.setPosTime("4");break;case KEYS.NUM5:this.setPosTime("5");break;case KEYS.NUM6:this.setPosTime("6");break;case KEYS.NUM7:this.setPosTime("7");break;case KEYS.NUM8:this.setPosTime("8");break;case KEYS.NUM9:this.setPosTime("9");break;case KEYS.F2:this.togglePlaylist();break;default:e.preventDefault()}return!1},MediaPlayer.preparePlayer=function(list,parent,fullScreen,play,show){if(echo(list,"MediaPlayer.preparePlayer->list to play "+play),0===list.length||!parent)return!1;this.playListShow=!1,this.$PlayerList.style.display="none",this.parent=parent,play=play===!0,this.fullScreen=fullScreen!==!1,this.fullScreen=!this.fullScreen,this.PlayList.playIndex=0,this.list=list,this.PlayList.Reset();for(var i=0;i<this.list.length;i++)this.PlayList.Add(list[i].name,{index:i,url:list[i].url},{stared:!1}),this.list[i].play&&(this.PlayList.playIndex=i);return this.prepare(this.list[this.PlayList.playIndex],play)?(this.PlayList.activeItem=this.PlayList.handle.children[this.PlayList.playIndex],this.$PlayerList.style.display="none",this.list.length>1?($playerHideplist.style.display="block",$playerHideplist.innerHTML=lang.playerBtnF2sh):$playerHideplist.style.display="none",show&&this.Show(!0,parent),play&&ListPage.Preview.setPosition(this.obj),this.changeScreenMode(fullScreen),!0):!1},MediaPlayer.prepare=function(obj,play,slideShow){if(echo(obj,"prepare "+play),clearTimeout(this.timer.showInfo),clearTimeout(this.timer.startPlaying),gSTB.Set3DConversionMode&&gSTB.Set3DConversionMode(0),this.$PlayerTotalTime.innerHTML="00:00:00",this.$PlayerCurrentTime.innerHTML="00:00:00",this.$PlayerBufferBar.style.width="0px",this.$PlayerProgressBar.style.width="0px",this.pos=0,this.curTime=0,this.totalTime=0,this.infoFlag=!0,this.countError=0,this.obj=obj,this.$PlayerTitle.innerHTML=obj.name,this.$PlayerHeader.style.display=slideShow?"none":"block",this.$PlayerFooter.style.display=slideShow?"none":"block",this.type!==obj.type){if(this.$SlideContainer.style.visibility="hidden",this.type=obj.type,"function"!=typeof this.init[this.type])return!1;this.init[this.type]();for(var a=0;a<this.ModalMenu.Menu.handleInner.children.length;a++)this.ModalMenu.Menu.Hidden(this.ModalMenu.Menu.handleInner.children[a],!0);if(echo("this.type="+this.type),"function"!=typeof this.modalInit[this.type])return!1;this.modalInit[this.type]()}return play&&(this.timer.startPlaying=window.setTimeout(function(){MediaPlayer.play()},100)),!0},MediaPlayer.play=function(){return this.obj?(clearTimeout(this.timer.slideShow),this.type===MEDIA_TYPE_IMAGE&&(this.obj.sol="jpeg",this.slideOn>0&&(this.timer.slideShow=window.setTimeout(function(){MediaPlayer.list.length>1&&MediaPlayer.fullScreen&&MediaPlayer.PlayList.playIndex+1<MediaPlayer.list.length&&(MediaPlayer.PlayList.playIndex++,MediaPlayer.PlayList.Focused(MediaPlayer.PlayList.handle.children[MediaPlayer.PlayList.playIndex],!0),MediaPlayer.prepare(MediaPlayer.list[MediaPlayer.PlayList.activeItem.data.index],!0,!0),ListPage.Preview.setPosition(MediaPlayer.obj))},1e3*this.slideOn))),void(deviceProxy.length<1?gSTB.Play((this.obj.sol?this.obj.sol+" ":"auto ")+this.obj.url):gSTB.Play((this.obj.sol?this.obj.sol+" ":"auto ")+this.obj.url,deviceProxy))):!1},MediaPlayer.setPos=function(a){var to,i,curTime,px;if(!this.playNow)return!1;for(this.posModFlag=!0,clearTimeout(this.timer.setPos),clearTimeout(this.timer.showInfo),this.posTime="",this.runner.stop(),0===this.pos&&(this.curTime=gSTB.GetPosTime(),this.posIntervals.splice(0,1),this.posIntervals[3]=this.posIntervals[2]+10,this.infoFlag=!1,this.showInfo(!0,0,!1),this.pos=this.curTime),this.posMod!==a?(this.posMod=a,this.posIntervals=[0,10,20]):(this.posIntervals.splice(0,1),this.posIntervals[this.posIntervals.length]=this.posIntervals[this.posIntervals.length-1]+10),to=0,i=0;i<this.posIntervals.length;i++)to+=a*this.posIntervals[i];return to>1800&&(to=1800),-1800>to&&(to=-1800),this.pos+=to,this.pos>this.totalTime&&(this.pos=this.totalTime-30),this.pos<0&&(this.pos=3),curTime=this.parseTime(this.pos),this.$PlayerCurrentTime.innerHTML=curTime.hour+":"+curTime.min+":"+curTime.sec,px=Math.round(this.pos/this.totalTime*this.progress[screen.height]),this.$PlayerProgressBar.style.width=px+"px",this.timer.setPos=window.setTimeout(function(){gSTB.SetPosTime(MediaPlayer.pos),MediaPlayer.pos=0,MediaPlayer.$PlayerCurrentTime.className="time_cur",MediaPlayer.posMod=0,gSTB.Continue(),MediaPlayer.posModFlag=!1},2e3),!1},MediaPlayer.setPosTime=function(a){if(this.playNow){this.posModFlag=!0,this.showInfo(!0,0,!1),this.posMod=0,clearTimeout(this.timer.setPos),clearTimeout(this.timer.showInfo),this.runner.stop(),this.posTime+=a,echo(this.posTime,"this.posTime"),this.pos=this.splitTime(this.posTime),this.pos>this.totalTime&&(this.pos=this.totalTime-30);var curTime=this.parseTime(this.pos);this.$PlayerCurrentTime.innerHTML=curTime.hour+":"+curTime.min+":"+curTime.sec,this.$PlayerCurrentTime.className="time_cur input";var px=Math.round(this.pos/this.totalTime*this.progress[screen.height]);this.$PlayerProgressBar.style.width=px+"px",this.timer.setPos=window.setTimeout(function(){echo(MediaPlayer.pos,"set pos:"),gSTB.SetPosTime(MediaPlayer.pos),MediaPlayer.pos=0,MediaPlayer.posTime="",MediaPlayer.posMod=0,MediaPlayer.$PlayerCurrentTime.className="time_cur",gSTB.Continue(),MediaPlayer.posModFlag=!1},2e3)}},MediaPlayer.playPause=function(){var self=this;if(echo(pauseData.paused,"old state -> pauseData.paused:"),!this.playNow){if(this.type!==MEDIA_TYPE_IMAGE)return!1;this.timer.slideShow?(clearTimeout(this.timer.slideShow),this.timer.slideShow=null):this.slideOn>0&&(this.timer.slideShow=setTimeout(function(){self.list.length>1&&self.fullScreen&&self.PlayList.playIndex+1<self.list.length&&(self.PlayList.playIndex++,self.PlayList.Focused(self.PlayList.handle.children[self.PlayList.playIndex],!0),self.prepare(self.list[self.PlayList.activeItem.data.index],!0),ListPage.Preview.setPosition(self.obj))},1e3*this.slideOn))}return gSTB.IsPlaying()?(this.showInfo(!0,0,!1),pauseData.paused||(pauseData={paused:!0,curTime:gSTB.GetPosTime(),fileLength:gSTB.GetMediaLen(),audioTrack:gSTB.GetAudioPID()}),gSTB.Pause(),ListPage.subscribeEvents[self.EVENT_PAUSE].call(ListPage,!0),this.runner.stop()):(deviceProxy.length<1?gSTB.Play((this.obj.sol?this.obj.sol+" ":"auto ")+this.obj.url+" position:"+pauseData.curTime):gSTB.Play((this.obj.sol?this.obj.sol+" ":"auto ")+this.obj.url+" position:"+pauseData.curTime,deviceProxy),ListPage.subscribeEvents[self.EVENT_PAUSE].call(ListPage,!1),this.runner.start(),this.timer.showInfo=window.setTimeout(function(){echo("showInfo_2"),MediaPlayer.showInfo(!1)},5e3)),!1},MediaPlayer.event=function(e,info){switch(echo(e,"event:"),echo(info,"event useless info:"),e=parseInt(e)){case 1:if(MediaPlayer.list.length>1&&MediaPlayer.PlayList.playIndex+1<MediaPlayer.list.length){MediaPlayer.PlayList.playIndex++,MediaPlayer.PlayList.Focused(MediaPlayer.PlayList.handle.children[MediaPlayer.PlayList.playIndex],!0),MediaPlayer.prepare(MediaPlayer.list[MediaPlayer.PlayList.activeItem.data.index],!0),ListPage.Preview.setPosition(MediaPlayer.obj);break}currCPage===MediaPlayer?MediaPlayer.exit():MediaPlayer.end();break;case 2:switch(MediaPlayer.type){case MEDIA_TYPE_AUDIO:case MEDIA_TYPE_VIDEO:if(pauseData.paused)echo("restore audio track, reset pause"),gSTB.SetAudioPID(pauseData.audioTrack),pauseData={curTime:0,fileLength:0,paused:!1,audioTrack:0};else{echo("init audio track"),MediaPlayer.curTime=0,MediaPlayer.totalTime=gSTB.GetMediaLen(),echo("MediaPlayer.curTime : "+MediaPlayer.curTime+" MediaPlayer.totalTime : "+MediaPlayer.totalTime);var curTime=MediaPlayer.parseTime(MediaPlayer.totalTime);MediaPlayer.$PlayerTotalTime.innerHTML=curTime.hour+":"+curTime.min+":"+curTime.sec,MediaPlayer.setAudioMenu()}}break;case 4:switch(MediaPlayer.playNow||ListPage.subscribeEvents[MediaPlayer.EVENT_START].call(ListPage),MediaPlayer.type){case MEDIA_TYPE_AUDIO:case MEDIA_TYPE_VIDEO:MediaPlayer.runner.start(),MediaPlayer.timer.showInfo=window.setTimeout(function(){echo("showInfo_3"),MediaPlayer.showInfo(!1)},5e3)}MediaPlayer.playNow=!0;break;case 5:switch(ListPage.subscribeEvents[MediaPlayer.EVENT_ERROR].call(ListPage),MediaPlayer.type){case MEDIA_TYPE_VIDEO:case MEDIA_TYPE_AUDIO:MediaPlayer.list.length>1&&MediaPlayer.fullScreen?MediaPlayer.PlayList.playIndex+1<MediaPlayer.list.length&&(MediaPlayer.PlayList.playIndex++,MediaPlayer.PlayList.Focused(MediaPlayer.PlayList.handle.children[MediaPlayer.PlayList.playIndex],!0),MediaPlayer.prepare(MediaPlayer.list[MediaPlayer.PlayList.activeItem.data.index],!0),ListPage.Preview.setPosition(MediaPlayer.obj),new CModalHint(currCPage,lang.playingError,3e3)):currCPage===MediaPlayer?(MediaPlayer.exit(),
window.setTimeout(function(){new CModalHint(currCPage,lang.playingError,3e3)},50)):MediaPlayer.end()}break;case 6:case 7:case 8:case 9:case 32:clearTimeout(standBy.standByOnTimer),clearTimeout(standBy.standByOffTimer),gSTB.GetStandByStatus()&&environment.hdmi_event_delay&&(standBy.standByOffTimer=setTimeout(function(){standBy.toggleMode()},1e3*environment.hdmi_event_delay));break;case 33:clearTimeout(standBy.standByOnTimer),clearTimeout(standBy.standByOffTimer),!gSTB.GetStandByStatus()&&environment.hdmi_event_delay&&(standBy.standByOnTimer=setTimeout(function(){standBy.toggleMode()},1e3*environment.hdmi_event_delay));break;case 35:case 34:}};var standBy={toggleMode:function(){this.status=!this.status,this.status?(currCPage===MediaPlayer&&MediaPlayer.playPause(),gSTB.SetLedIndicatorMode(1),gSTB.StandBy(!0)):(gSTB.SetLedIndicatorMode(2),gSTB.StandBy(!1),currCPage===MediaPlayer&&MediaPlayer.playPause(),currCPage===MainPage&&MainPage.newsList.isActive&&MainPage.typeList.Activate(!0))},status:!1,standByOnTimer:0,standByOffTimer:0};MediaPlayer.aspect=function(){var $ico;clearTimeout(this.timer.hideAspect),this.activeAspect++,this.activeAspect>=this.aspects.length&&(this.activeAspect=0),$ico=this.handle.querySelector(".mediaHeaderIco"),gSTB.SetAspect(this.aspects[this.activeAspect].mode),$ico.innerHTML='<img src="lang/'+this.currLang+"/"+(1920===screen.width?"1920/":"")+this.aspects[this.activeAspect].img+'">',$ico.style.display="inline",this.timer.hideAspect=window.setTimeout(function(){$ico.style.display="none"},2e3)},MediaPlayer.end=function(){if(!this.obj)return!0;ListPage.subscribeEvents[this.EVENT_STOP].call(ListPage),this.obj=null,this.runner.stop();for(var i in this.timer)this.timer.hasOwnProperty(i)&&clearTimeout(this.timer[i]);return gSTB.Stop(),this.playNow=!1,!0},MediaPlayer.exit=function(){return $cright.style.display="none",this.handle.querySelector(".mediaHeaderIco").style.display="none",this.end()&&(ListPage.subscribeEvents[this.EVENT_EXIT].call(ListPage),this.Show(!1)),!1},MediaPlayer.setCoord=function(x,y,a,b){echo("MediaPlayer.setCoord "+x+" "+y+" "+a+" "+b+"!"),x&&(this.coord.x=x),y&&(this.coord.y=y),a&&(this.coord.a=a),b&&(this.coord.b=b)},MediaPlayer.changeScreenMode=function(fullScreen){if(echo("MediaPlayer.changeScreenMode "+fullScreen+" "+(this.fullScreen===fullScreen)),fullScreen===!0||fullScreen===!1){if(this.fullScreen===fullScreen)return;this.fullScreen=fullScreen}else this.fullScreen=!this.fullScreen;this.fullScreen?gSTB.SetPIG(1,0,0,0):this.coord.a&&this.coord.b&&(echo("SET VIEW PORT TO WINDOW"),gSTB.SetViewport(this.coord.a,this.coord.b,this.coord.x,this.coord.y))},MediaPlayer.showInfo=function(show,hidetime,showHeader){if(clearTimeout(this.timer.showInfo),show===!1||show===!0){if(show===this.infoFlag)return!1;this.infoFlag=!show}return this.infoFlag?(this.$PlayerHeader.style.display="none",this.$PlayerList.style.display="none",this.playListShow=!1,$playerHideplist.innerHTML=lang.playerBtnF2sh,this.$PlayerFooter.style.display="none",this.type!==MEDIA_TYPE_AUDIO&&(this.$SlideContainer.style.visibility="hidden")):(this.$PlayerHeader.style.display="block",this.playListShow&&(this.$PlayerList.style.display="block",this.PlayList.Refresh()),this.type===MEDIA_TYPE_AUDIO&&(this.$SlideContainer.style.visibility="visible"),this.$PlayerFooter.style.display="block"),this.infoFlag=!this.infoFlag,hidetime&&(this.timer.showInfo=window.setTimeout(function(){echo("showInfo_5"),MediaPlayer.showInfo(!MediaPlayer.infoFlag)},hidetime)),!1},MediaPlayer.parseTime=function(a){var h,m,s;return a>=0?(h=Math.floor(a/3600),m=Math.floor((a-3600*h)/60),s=a-3600*h-60*m,10>h&&(h="0"+h),10>s&&(s="0"+s),10>m&&(m="0"+m)):(a=Math.abs(a),h=Math.floor(a/3600),m=Math.floor((a-3600*h)/60),s=a-3600*h-60*m,10>h&&(h="0"+h),10>s&&(s="0"+s),10>m&&(m="0"+m),h="-"+h),{hour:h,min:m,sec:s}},MediaPlayer.splitTime=function(a){var s,m,h;return a=parseInt(a),s=a%100,m=(a%1e4-s)/100,h=Math.floor(a/1e4),s>59&&(s=59),m>59&&(m=59),s+60*m+3600*h},MediaPlayer.runner={id:{},run:!1,start:function(){var px,curTime,persent;this.run||(MediaPlayer.curTime=gSTB.GetPosTime(),MediaPlayer.curTime>MediaPlayer.totalTime&&(MediaPlayer.curTime=MediaPlayer.totalTime),MediaPlayer.curTime<0&&(MediaPlayer.curTime=0),px=Math.round(MediaPlayer.curTime/MediaPlayer.totalTime*MediaPlayer.progress[screen.height]),curTime=MediaPlayer.parseTime(MediaPlayer.curTime),persent=Math.round(MediaPlayer.curTime/MediaPlayer.totalTime*100),ListPage.subscribeEvents[MediaPlayer.EVENT_PROGRESS].call(ListPage,persent),MediaPlayer.$PlayerCurrentTime.innerHTML=curTime.hour+":"+curTime.min+":"+curTime.sec,MediaPlayer.$PlayerProgressBar.style.width=px+"px",this.id=window.setInterval(function(){var persent,px,curTime;MediaPlayer.curTime=gSTB.GetPosTime(),MediaPlayer.curTime>MediaPlayer.totalTime&&(MediaPlayer.curTime=MediaPlayer.totalTime),MediaPlayer.curTime<0&&(MediaPlayer.curTime=0),persent=Math.round(MediaPlayer.curTime/MediaPlayer.totalTime*100),ListPage.subscribeEvents[MediaPlayer.EVENT_PROGRESS].call(ListPage,persent),px=Math.round(MediaPlayer.curTime/MediaPlayer.totalTime*MediaPlayer.progress[screen.height]),curTime=MediaPlayer.parseTime(MediaPlayer.curTime),MediaPlayer.$PlayerCurrentTime.innerHTML=curTime.hour+":"+curTime.min+":"+curTime.sec,MediaPlayer.$PlayerProgressBar.style.width=px+"px"},1e3),this.run=!0)},stop:function(){this.run&&(this.run=!1,clearInterval(this.id))}},MediaPlayer.SubscribersReset=function(){this.subscribers[this.EVENT_START]=[],this.subscribers[this.EVENT_STOP]=[],this.subscribers[this.EVENT_PAUSE]=[],this.subscribers[this.EVENT_PROGRESS]=[],this.subscribers[this.EVENT_ERROR]=[],this.subscribers[this.EVENT_OK]=[],this.subscribers[this.EVENT_EXIT]=[]},MediaPlayer.Subscribe=function(subscriber,eventType){subscriber.subscribeEvents&&subscriber.subscribeEvents[eventType]instanceof Function&&-1===this.subscribers[eventType].indexOf(subscriber)&&this.subscribers[eventType].push(subscriber)},MediaPlayer.Unsubscribe=function(subscriber,eventType){var index=this.subscribers[eventType].indexOf(subscriber);-1!==index&&this.subscribers[eventType].splice(index,1)},MediaPlayer.setAudioMenu=function(){var audArr=[],subArr=[],currAud,lang_info,i,currSub;try{audArr=eval(gSTB.GetAudioPIDsEx())}catch(e){echo(e)}if(currAud=gSTB.GetAudioPID(),this.ModalMenu.Menu.gaudio.slist.Clear(),echo(audArr,"audArr: (this.subtitles_on="+this.subtitles_on+" currAud="+currAud+")"),audArr.length>0&&audArr[0]&&audArr[0].pid)for(echo("there is another audio"),i=0;i<audArr.length;i++){lang_info=getLanguageNameByCode(audArr[i].lang),lang_info||(lang_info=[],lang_info[0]=lang.mediaInfoMenuLangUnknown+' ("'+getIso639LangCode(audArr[i].lang)+'")',lang_info[1]="null");var fl=currAud===audArr[i].pid;this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gaudio,lang_info[1],lang_info[0],{data:audArr[i].pid,marked:fl}),fl&&(this.handle.querySelector("#audioType").src="img/codec/codec"+audArr[i].type+".png",this.handle.querySelector("#audioText").innerHTML=lang_info[0],this.handle.querySelector("#cright").style.display="block",this.timer.audio=window.setTimeout(function(){MediaPlayer.handle.querySelector("#cright").style.display="none"},5e3))}else echo("no other audio"),this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gaudio,"no",lang.mediaMenuNo,{disabled:!0});currSub=gSTB.GetSubtitlePID(),echo("gSTB.GetSubtitlePID()="+currSub);try{subArr=eval(gSTB.GetSubtitlePIDs())}catch(e){echo(subArr,"error subArr")}if(this.ModalMenu.Menu.gsubtitle.slist.Clear(),echo(subArr,"subArr"),gSTB.SetSubtitles(!!this.subtitles_on),subArr.length>0)for(this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gsubtitle,"OFF",lang.mediaMenuOff,{data:"OFF",marked:this.subtitles_on!==!0}),i=0;i<subArr.length;i++)lang_info=getLanguageNameByCode(subArr[i].lang),echo(lang_info,"lang_info"),lang_info||(lang_info=[],lang_info.push(lang.mediaInfoMenuLangUnknown+'&nbsp;("'+getIso639LangCode(subArr[i].lang)+'")'),lang_info.push("null")),this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gsubtitle,lang_info[1],lang_info[0],{data:subArr[i].pid,marked:currSub===subArr[i].pid&&this.subtitles_on===!0});else this.ModalMenu.Menu.AddItem(this.ModalMenu.Menu.gsubtitle,"no",lang.mediaMenuNo,{disabled:!0}),echo("no subtitles")},PlayList.prototype=Object.create(CScrollList.prototype),PlayList.prototype.constructor=PlayList,PlayList.prototype.Add=function(name,attrs,states){var item,body=element("div",{className:"data"},name),star=element("div",{className:"star"});return item=CScrollList.prototype.Add.call(this,[body,star],{star:star,data:{index:attrs.index||0===attrs.index?attrs.index:"",url:attrs.url?attrs.url:"",pos:attrs.pos||0===attrs.pos?attrs.pos:"",parentI:attrs.parentI||0===attrs.parentI?attrs.parentI:""},disabled:attrs.disabled?!0:!1,focused:attrs.focused?!0:!1,marked:attrs.marked?!0:!1,onclick:function(){return this.self.Open(this.data),!1},oncontextmenu:function(){return!1}})},PlayList.prototype.Clear=function(){CScrollList.prototype.Clear.call(this),this.filterType=MEDIA_TYPE_NONE,this.filterText="",this.mtypes=[]},PlayList.prototype.Open=function(data){echo(data,"PlayList.Open :: data"),MediaPlayer.prepare(MediaPlayer.list[data.index],!0),this.playIndex=data.index,this.parentIndex=data.parentI,ListPage.Preview.setPosition(this.parent.obj),echo(MediaPlayer.list,"MediaPlayer.list")},PlayList.prototype.Reset=function(){this.path=[],this.Clear()},PlayList.prototype.Refresh=function(){this.Activate(),this.Focused(this.activeItem,!0)},MediaPlayer.addPreviewList=function(){var list=[],items=CSListManager.Current().Find({marked:!0});return echo("FOUND marked items?"),0===items.length&&(echo("NOPE"),items=Array.prototype.slice.call(CSListManager.Current().handleInner.children)),-1===items.indexOf(CSListManager.Current().Current())&&items.unshift(CSListManager.Current().Current()),items.forEach(function(item){-1!==CSListManager.playable.indexOf(item.data.type)&&(item.data.play=CSListManager.Current().Current()===item,list.push(item.data))}),list};var CSListManager={};CSListManager.init=function(handleInner,parentPage){CSListManager.handleInner=handleInner,CSListManager.current=null,CSListManager.src=[],this.playable=[MEDIA_TYPE_VIDEO,MEDIA_TYPE_AUDIO,MEDIA_TYPE_IMAGE],CSListManager.SearchBarVisibility=!0,CSListManager.parent=parentPage,this.mode=NORMAL_MODE,this.parentData=null,this.LEVEL_CHANGE_NONE=0,this.LEVEL_CHANGE_UP=-1,this.LEVEL_CHANGE_DOWN=1,this.action_open={},this.action_open[ROOT_VIDEO]=this.openRoot,this.action_open[ROOT_AUDIO]=this.openRoot,this.action_open[ROOT_IMAGE]=this.openRoot,this.action_open[ROOT_FAVS]=this.openRoot,this.action_open[TYPE_BACK]=this.openBack,this.action_open[ROOT_GLOBAL_SEARCH]=this.openGSearchRoot,this.action_open[LOCAL_SEARCH_ROOT]=this.openGSearchRoot,this.action_open[TYPE_NONE]=this.openTypeNone,this.action_open[MEDIA_OBJECT]=this.openMediaObject,this.action_open[MEDIA_FOLDER]=this.openMediaFolder,this.action_open[RADIO_OBJECT]=this.openRadioObject,this.action_open[ACTORS_FOLDER]=this.openActorsFolder,this.action_open[GLOBAL_SEARCH_FOLDER]=this.openGSearchFolder,this.action_open[ORPHAN_FOLDER]=this.openGSearchFolder,this.action_open[GLOBAL_SEARCH_REFRESH]=this.openRefresh,this.action_open[LOCAL_SEARCH_REFRESH]=this.openRefresh,this.action_open[WHAT_IS_THIS_TYPE]=this.openUnknownType,this.action_open[ROOT_NEWS]=this.openUnknownType,this.action_open[MEDIA_TYPE_VIDEO]=this.openFile,this.action_open[MEDIA_TYPE_AUDIO]=this.openFile,this.action_open[MEDIA_TYPE_IMAGE]=this.openFile},CSListManager.Current=function(){return CSListManager.src[CSListManager.src.length-1]},CSListManager.Open=function(data){var levelChange;echo(data,"CSListManager.Open :: data"),data.type!==MEDIA_TYPE_VIDEO&&data.type!==MEDIA_TYPE_AUDIO&&data.type!==MEDIA_TYPE_IMAGE||!cat_focus_timer||(clearTimeout(cat_focus_timer),ListPage.Preview.info(CSListManager.Current().Current().data)),data.type!==MEDIA_TYPE_VIDEO&&data.type!==MEDIA_TYPE_AUDIO&&data.type!==MEDIA_TYPE_IMAGE&&elclear(ListPage.Preview.body),levelChange=this.Build(data),this.parentData=data,levelChange===this.LEVEL_CHANGE_NONE&&(echo("LEVEL_CHANGE_NONE"),data.type!==TYPE_NONE&&data.type!==MEDIA_TYPE_VIDEO&&data.type!==MEDIA_TYPE_AUDIO&&data.type!==MEDIA_TYPE_IMAGE&&(ListPage.breadCrumb.Pop(),ListPage.breadCrumb.Push("/",typeInfo[data.type].icon,data.title))),levelChange===this.LEVEL_CHANGE_DOWN&&(echo("LEVEL_CHANGE_DOWN"),CSListManager.src.length>1&&(echo("this.src.length>1"),CSListManager.src[CSListManager.src.length-2].Show(!1)),data.type!==TYPE_NONE&&data.type!==MEDIA_TYPE_VIDEO&&data.type!==MEDIA_TYPE_AUDIO&&data.type!==MEDIA_TYPE_IMAGE&&ListPage.breadCrumb.Push("/",typeInfo[data.type].icon,data.title),this.SearchBarVisibility===!0&&(this.mode===LSEARCH_MODE&&this.src.length>2||this.mode===NORMAL_MODE&&this.src.length>1)&&(echo("search hide"),this.parent.SearchBar.Show(!1,!1),this.SearchBarVisibility=!1)),levelChange===this.LEVEL_CHANGE_UP&&(echo("LEVEL_CHANGE_UP"),CSListManager.parent.breadCrumb.Pop(),CSListManager.src.length>0&&(CSListManager.parentData=CSListManager.Current().handleInner.data),1===CSListManager.src.length&&(CSListManager.mode=NORMAL_MODE,CSListManager.Current().Current().focus()),this.SearchBarVisibility===!1&&(this.mode===LSEARCH_MODE&&this.src.length<3||this.mode===NORMAL_MODE&&this.src.length<2)&&(echo("search show"),this.parent.SearchBar.Show(!0,!1),this.SearchBarVisibility=!0),0===CSListManager.src.length&&(this.parent.SearchBar.Show(!0,!1),CSListManager.trash.Clear(),this.handleInner.removeChild(CSListManager.trash.handleInner),echo("---PAGE CHANGE---"),ListPage.Show(!1),MainPage.LastActComp.Activate(!0,!0)))},CSListManager.Build=function(data){var levelChange=this.LEVEL_CHANGE_NONE;return echo(data,"CSListManager.Build:: data"),data&&data.type&&this.action_open[data.type]instanceof Function?levelChange=this.action_open[data.type].call(this,data):(echo("wrong item type"),new CModalAlert(CSListManager.parent,lang.mediaDefaultError,lang.mediaItemWrongType,lang.mediaDefaultClose)),levelChange},CSListManager.openBack=function(data){return echo(data,"openBack"),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),CSListManager.trash=CSListManager.src.pop(),this.src.length>0&&(CSListManager.Current().Show(!0),CSListManager.Current().Activate(!0),CSListManager.trash.Show(!1),CSListManager.trash.Clear(),CSListManager.handleInner.removeChild(CSListManager.trash.handleInner),CSListManager.parent.onFocusAction(CSListManager.Current().Current(),"")),this.LEVEL_CHANGE_UP},CSListManager.openTypeNone=function(data){echo("openTypeNone"),echo('Wrong file type. Press "BACK" to exit.')},CSListManager.openRoot=function(data){var self=this,getHeaders={charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/x-www-form-urlencoded"};return echo("openRoot type="+data.type),data.url=typeInfo[data.type].urlStart+data.url+typeInfo[data.type].urlEnd,this.AddCSList(data),this.Current().onFocus=function(current_item){var curr_list_length,cur_list_handleInner,doc;echo(current_item,"CSListManager.Current().onFocus"),self.parent.onFocusAction(current_item,""),curr_list_length=self.Current().handleInner.childNodes.length,cur_list_handleInner=self.Current().handleInner,echo("current_item.data.iid ="+current_item.data.iid+" curr_list_length="+curr_list_length),current_item.data.iid!==curr_list_length-2&&current_item.data.iid>curr_list_length-self.parent.ItemsPerPage/2&&cur_list_handleInner.page_length>=cur_list_handleInner.page_index&&(doc=self.Current().handleInner,echo("iid_scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+ListPage.ItemsPerPage),doc.data.type!==ROOT_FAVS&&ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+self.parent.ItemsPerPage,htmlListParser,{}))},CSListManager.Current().handleInner.onscroll=function(){var doc=CSListManager.Current().handleInner,scrollPosition=doc.scrollTop,pageSize=doc.scrollHeight-doc.clientHeight,percentageScrolled=Math.floor(scrollPosition/pageSize*100);echo("on scroll "),100===percentageScrolled&&doc.page_length>=doc.page_index&&(echo("scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage),doc.data.type!==ROOT_FAVS&&ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},echo("first request is="+data.url+"&p=0&per="+this.parent.ItemsPerPage),data.type===ROOT_FAVS?ajax("get",favApiUrl+"favorites/media?info.catId="+data.url,favsListParser,getHeaders,"json"):ajax("GET",data.url+"&p=0&per="+this.parent.ItemsPerPage,htmlListParser,{}),this.LEVEL_CHANGE_DOWN},CSListManager.openGSearchRoot=function(data){return echo(data,"openGSearchRoot"),CSListManager.AddCSList(data),CSListManager.Current().onFocus=function(current_item){var curr_list_length,cur_list_handleInner,doc;echo(current_item,"CSListManager.Current().onFocus"),CSListManager.parent.onFocusAction(current_item,""),curr_list_length=CSListManager.Current().handleInner.childNodes.length,cur_list_handleInner=CSListManager.Current().handleInner,echo("current_item.data.iid ="+current_item.data.iid+" curr_list_length="+curr_list_length),current_item.data.iid!==curr_list_length-2&&current_item.data.iid>curr_list_length-CSListManager.parent.ItemsPerPage/2&&cur_list_handleInner.page_length>=cur_list_handleInner.page_index&&(doc=CSListManager.Current().handleInner,echo("iid_scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per=20"),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlSearchParser,{}))},CSListManager.Current().handleInner.onscroll=function(){var doc=CSListManager.Current().handleInner,scrollPosition=doc.scrollTop,pageSize=doc.scrollHeight-doc.clientHeight,percentageScrolled=Math.floor(scrollPosition/pageSize*100);echo("on scroll "),100===percentageScrolled&&doc.page_length>=doc.page_index&&(echo("scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlSearchParser,{}))},echo("first request is="+data.url+"&p=0&per="+this.parent.ItemsPerPage),ajax("GET",data.url+"&p=0&per="+this.parent.ItemsPerPage,htmlSearchParser,{}),this.LEVEL_CHANGE_DOWN},CSListManager.openRefresh=function(data){return echo(data,"openRefresh"),CSListManager.Current().Clear(),CSListManager.Current().handleInner.data.url=data.url,CSListManager.Current().handleInner.page_index=0,CSListManager.Current().handleInner.page_length=0,echo("rewrite req="+data.url+"&p=0&per="+this.parent.ItemsPerPage),ajax("GET",data.url+"&p=0&per="+this.parent.ItemsPerPage,htmlSearchParser,{}),this.LEVEL_CHANGE_NONE},CSListManager.openGSearchFolder=function(data){return echo(data,"openGSearchFolder"),CSListManager.AddCSList(data),CSListManager.Current().onFocus=function(current,previous){var curr_list_length,cur_list_handleInner;if(this.parent.onFocusAction(current,previous),curr_list_length=CSListManager.Current().handleInner.childNodes.length,cur_list_handleInner=CSListManager.Current().handleInner,echo("current.data.iid ="+current.data.iid+" curr_list_length="+curr_list_length),current.data.iid!==curr_list_length-2&&current.data.iid>curr_list_length-CSListManager.parent.ItemsPerPage/2&&cur_list_handleInner.page_length>=cur_list_handleInner.page_index){var doc=CSListManager.Current().handleInner;echo("iid_scroll=100%=>ajax="+doc.data.url+"?p="+doc.page_index+"&per="+ListPage.ItemsPerPage),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{})}},CSListManager.Current().handleInner.onscroll=function(){var doc=CSListManager.Current().handleInner,scrollPosition=doc.scrollTop,pageSize=doc.scrollHeight-doc.clientHeight,percentageScrolled=Math.floor(scrollPosition/pageSize*100);echo("on scroll "),100===percentageScrolled&&doc.page_length>=doc.page_index&&(echo("scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},echo("first request is="+data.url+"?p=0&per="+this.parent.ItemsPerPage),ajax("GET",data.url+"?p=0&per="+this.parent.ItemsPerPage,htmlListParser,{}),this.LEVEL_CHANGE_DOWN},CSListManager.openMediaObject=function(data){return echo(data,"openMediaObject"),CSListManager.AddCSList(data),CSListManager.SearchBarVisibility===!0&&(echo("search hide"),this.parent.SearchBar.Show(!1,!1),CSListManager.SearchBarVisibility=!1),CSListManager.Current().onFocus=function(current,previous){CSListManager.parent.onFocusAction(current,previous)},echo("AJAX START="+data.url),ajax("GET",data.url,htmlObjectParser,{}),setTimeout(function(){CSListManager.parent.messageHint=new CModalHint(CSListManager.parent,"Loading...")},1),this.LEVEL_CHANGE_DOWN},CSListManager.openMediaFolder=function(data){return echo("openMediaFolder type="+data.type),CSListManager.AddCSList(data),CSListManager.Current().onFocus=function(current,previous){var curr_list_length,cur_list_handleInner,doc;this.parent.onFocusAction(current,previous),curr_list_length=CSListManager.Current().handleInner.childNodes.length,cur_list_handleInner=CSListManager.Current().handleInner,echo("current.data.iid ="+current.data.iid+" curr_list_length="+curr_list_length),current.data.iid!==curr_list_length-2&&current.data.iid>curr_list_length-CSListManager.parent.ItemsPerPage/2&&cur_list_handleInner.page_length>=cur_list_handleInner.page_index&&(doc=CSListManager.Current().handleInner,echo("iid_scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+ListPage.ItemsPerPage),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},CSListManager.Current().handleInner.onscroll=function(){var doc=CSListManager.Current().handleInner,scrollPosition=doc.scrollTop,pageSize=doc.scrollHeight-doc.clientHeight,percentageScrolled=Math.floor(scrollPosition/pageSize*100);echo("on scroll "),100===percentageScrolled&&doc.page_length>=doc.page_index&&(echo("scroll=100%=>ajax="+doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage),ajax("GET",doc.data.url+"&p="+doc.page_index+"&per="+CSListManager.parent.ItemsPerPage,htmlListParser,{}))},echo("first request is="+data.url+"&p=0&per="+this.parent.ItemsPerPage),ajax("GET",data.url+"&p=0&per="+this.parent.ItemsPerPage,htmlListParser,{}),this.LEVEL_CHANGE_DOWN},CSListManager.openRadioObject=function(data){return echo(data,"openRadioObject"),CSListManager.AddCSList(data),this.SearchBarVisibility===!0&&(echo("search hide"),this.parent.SearchBar.Show(!1,!1),this.SearchBarVisibility=!1),CSListManager.Current().onFocus=function(current,previous){CSListManager.parent.onFocusAction(current,previous)},echo("AJAX START="+data.url),ajax("GET",data.url,htmlRadioParser,{}),setTimeout(function(){CSListManager.parent.messageHint=new CModalHint(CSListManager.parent,"Loading...")},1),this.LEVEL_CHANGE_DOWN},CSListManager.openActorsFolder=function(data){return echo(data,"openActorsFolder"),CSListManager.AddCSList(data),CSListManager.Current().onFocus=function(current,previous){this.parent.onFocusAction(current,previous)},echo("first request is="+data.url),ajax("GET",data.url,htmlActorsParser,{charset:"utf-8"}),this.LEVEL_CHANGE_DOWN},CSListManager.openUnknownType=function(data){return echo(data,"openUnknownType"),CSListManager.AddCSList(data),echo("first request is="+data.url),ajax("GET",data.url,htmlWhatIsThisParser,{charset:"utf-8"}),this.LEVEL_CHANGE_DOWN},CSListManager.openFile=function(data){var items,list=[];return echo(data,"openFile"),MediaPlayer.playNow||null!==MediaPlayer.obj?(MediaPlayer.changeScreenMode(!0),MediaPlayer.Show(!0,this.parent),this.LEVEL_CHANGE_NONE):(items=CSListManager.Current().Find({marked:!0}),echo("FIND marked items?"),0===items.length&&(echo("NOPE"),items=Array.prototype.slice.call(CSListManager.Current().handleInner.children)),items.forEach(function(item){-1!==CSListManager.playable.indexOf(item.data.type)&&(item.data.play=CSListManager.Current().Current()===item,list.push(item.data))}),MediaPlayer.preparePlayer(list,ListPage,!0,!0,!0),this.LEVEL_CHANGE_NONE)},CSListManager.AddCSList=function(data){var slist=new CScrollList(CSListManager.parent);echo("creating CSList"),slist.Init(element("div",{className:"cslist-main",data:data,page_index:0,page_length:0})),elchild(CSListManager.handleInner,slist.handleInner),CSListManager.src.push(slist),CSListManager.Current().Show(!0),CSListManager.Current().Activate(!0)};var CMODAL_IMG_PATH="/home/web/public/img/"+screen.width;CModal.prototype=Object.create(CPage.prototype),CModal.prototype.constructor=CModal,CModal.prototype.Init=function(body){CPage.prototype.Init.call(this,element("div",{className:"cmodal-main"},element("div",{className:"cmodal-cell"},body))),(this.parent&&this.parent.handle&&this.parent.handle.nodeName?this.parent.handle:document.body).appendChild(this.handle)},CModal.prototype.Free=function(){(this.parent?this.parent.handle:document.body).removeChild(this.handle),elclear(this.handle)},CModal.prototype.Show=function(visible,manageFocus){CBase.prototype.Show.call(this,visible,manageFocus!==!1),currCPage=visible===!1?this.parent:this},CModal.prototype.FocusPrev=function(event,manageVK){if(this.focusList.length>0){--this.focusPos<0&&(this.focusPos=this.focusList.length-1);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),"SELECT"!==el.nodeName&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModal.prototype.FocusNext=function(event,manageVK){if(this.focusList.length>0){++this.focusPos>=this.focusList.length&&(this.focusPos=0);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),event&&"SELECT"!==el.nodeName&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModalBox.prototype=Object.create(CModal.prototype),CModalBox.prototype.constructor=CModalBox,CModalBox.prototype.SetData=function(place,data){return elclear(place),data instanceof Node||data instanceof Array?elchild(place,data):place.innerHTML=data,data&&data.nodeName&&(data.style.display="block"),place.style.display=data?"block":"none",place},CModalBox.prototype.SetHeader=function(data){return this.SetData(this.header,data)},CModalBox.prototype.SetContent=function(data){return this.SetData(this.content,data)},CModalBox.prototype.SetFooter=function(data){return this.SetData(this.footer,data)},CModalBox.prototype.Init=function(){CModal.prototype.Init.call(this,element("div",{className:"cmodal-body"},[this.header,this.content,this.footer]))},CModalHint.prototype=Object.create(CModalBox.prototype),CModalHint.prototype.constructor=CModalHint,CModalAlert.prototype=Object.create(CModalBox.prototype),CModalAlert.prototype.constructor=CModalAlert,CModalConfirm.prototype=Object.create(CModalAlert.prototype),CModalConfirm.prototype.constructor=CModalConfirm,CModalSelectLang.prototype=Object.create(CModalBox.prototype),CModalSelectLang.prototype.constructor=CModalSelectLang,CModalAddDownload.prototype=Object.create(CModalBox.prototype),CModalAddDownload.prototype.constructor=CModalAddDownload,CButtonPanel.prototype=Object.create(CBase.prototype),CButtonPanel.prototype.constructor=CButtonPanel,CButtonPanel.prototype.Init=function(path,handle){this.path=path,handle&&handle.nodeName?CBase.prototype.Init.call(this,handle):CBase.prototype.Init.call(this,element("div",{className:"cbpanel-main"}))},CButtonPanel.prototype.Add=function(code,icon,text,callback,hidden){var html=null,self=this,func=function(){self.isActive&&callback instanceof Function&&callback(code)};text&&(html=element("div",{className:"cbpanel-text",onclick:func}),html.innerHTML=text);var item=element("div",{className:"cbpanel-item",data:{code:code,onclick:func}},[element("img",{className:"cbpanel-icon",onclick:func,src:this.path+"/"+icon}),html]);return this.Hidden(item,hidden||!1),elchild(this.handleInner,item),item},CButtonPanel.prototype.Hidden=function(item,state){item&&item.nodeName&&item.data.hidden!==state&&(item.data.hidden=state,item.style.display=state?"none":"table-cell")},CButtonPanel.prototype.Activate=function(active){this.isActive=active!==!1},CButtonPanel.prototype.EventHandler=function(event){if(this.isActive)for(var data,i=0,items=this.handleInner.children,length=items.length;length>i;i++)if(data=items[i].data,!data.hidden&&data.code===event.code&&data.onclick instanceof Function)return data.onclick(),void event.preventDefault()},CButtonPanel.prototype.onClick=function(){return!1},CBreadCrumb.prototype=Object.create(CBase.prototype),CBreadCrumb.prototype.constructor=CBreadCrumb,CBreadCrumb.prototype.Init=function(path,handle,litems,ritems){this.path=path,CBase.prototype.Init.call(this,handle),this.litems=litems||this.litems,this.ritems=ritems||this.ritems},CBreadCrumb.prototype.Push=function(path,icon,text){var last=this.handleInner.lastChild;last&&(last.className="cbcrumb-item");var item=element("div",{className:"cbcrumb-item active",onclick:null,path:path},[icon?element("img",{className:"cbcrumb-icon",onclick:null,src:this.path+"/"+icon}):null,text?element("div",{className:"cbcrumb-text",onclick:null},text):null]);return this.handleInner.children.length===this.litems&&elchild(this.handleInner,element("div",{className:"cbcrumb-item divider"},". . .")),elchild(this.handleInner,item),this.handleInner.children.length>this.litems+this.ritems+1&&(this.handleInner.children[this.litems].style.display="table-cell",this.handleInner.children[this.handleInner.children.length-this.ritems-1].style.display="none"),item},CBreadCrumb.prototype.Pop=function(){var item=this.handleInner.lastChild;return item&&(this.handleInner.removeChild(item),this.handleInner.children.length===this.litems+1?this.handleInner.removeChild(this.handleInner.lastChild):this.handleInner.children.length>this.litems+this.ritems&&(this.handleInner.children[this.handleInner.children.length-this.ritems].style.display="table-cell"),this.handleInner.children.length===this.litems+this.ritems+1&&(this.handleInner.children[this.litems].style.display="none"),this.handleInner.lastChild&&(this.handleInner.lastChild.className="cbcrumb-item active")),item},CBreadCrumb.prototype.Reset=function(){elclear(this.handleInner)},CBreadCrumb.prototype.onClick=function(){return!1};var stbEvent={onEvent:function(data){},onMessage:function(from,message,data){this.trigger(message,{from:from,data:data})},onBroadcastMessage:function(from,message,data){echo(message,"onBroadcastMessage"),this.trigger("broadcast."+message,{from:from,data:data})},event:0},MainPage=new CPage,ListPage=new CPage,_GET={referer:"",proxy:""};MainPage.name="MainPage",MainPage.favsList={urls:[],idsByUrl:{}},ListPage.name="ListPage",ListPage.Preview=new CBase(ListPage),ListPage.Info=new CBase(ListPage),function(){var getPar,x,l,i;if(getPar=String(window.location),x=getPar.indexOf("?"),-1!==x){l=getPar.length,getPar=getPar.substr(x+1,l-x),l=getPar.split("&"),x=0;for(i in l)l.hasOwnProperty(i)&&(getPar=l[i].split("="),_GET[getPar[0]]=getPar[1],x++)}deviceProxy=_GET.proxy}(),window.onload=function(){function getVersion(){var pathToRoot=location.pathname.split("/");pathToRoot[pathToRoot.length-1]="",ajax("get",location.protocol+"//"+location.host+pathToRoot.join("/")+"package.json",function(vData,status){try{vData=JSON.parse(vData)}catch(e){vData=null}window.version=vData.version||"n/a",document.getElementById("loadingVersion").innerHTML=vData.version||"",MainPage.userId=appConfig.userId,window.setTimeout(function(){document.getElementById("loading").style.display="none",loadScript("lang/"+appConfig.interfaceLang+".js",continueMainInit),ajax("get",favApiUrl+"favorites/media",fillFavIdsList,{charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/x-www-form-urlencoded"
},"json")},2e3)},null,null,!1)}function continueMainInit(){var exitElementsArr,i;if(echo("continueMainInit"),MainPage.handleInner=document.getElementById("MainPage"),MainPage.Init(MainPage.handleInner),window.ServiceMenu=MainPage,ListPage.handleInner=document.getElementById("ListPage"),ListPage.Init(ListPage.handleInner),MediaPlayer.handleInner=document.getElementById("pageMediaPlayer"),MediaPlayer.Init(MediaPlayer.handleInner),MediaPlayer.currLang=appConfig.interfaceLang,MainPage.$catTypeName=MainPage.handleInner.querySelector(".content  .mainContent  .servText"),MainPage.$catTypeName.innerHTML=lang.catVideo+":",MainPage.handleInner.querySelector(".content  .rightContent .servText").innerHTML=lang.news,useNewIcons)for(exitElementsArr=document.querySelectorAll(".exitValue"),i=0;i<exitElementsArr.length;i++)exitElementsArr[i].innerText=lang.exit;window.rightMenuTextLength=720===screen.width?117:200,gSTB.InitPlayer(),volume.init(),volume.setVol(volume.currVol),gSTB.EnableServiceButton(!0),window.parent!==window&&window.parent.postMessage("show","*")}function fillFavIdsList(data){try{data=data.data}catch(error){return echo("WARNING! PARSER fillFavIdsList ERROR!"),void echo("ERROR INFO: "+error)}if(data.length)for(var i=0;i<data.length;i++)MainPage.favsList.idsByUrl[data[i].info.url]=data[i].id,MainPage.favsList.urls.push(data[i].info.url)}echo("******** STB STARTED ********");var i,curLangIdx=getCurrentLanguage(),appConfig=gSTB.LoadUserData("ex.ua.data.json"),models=["AuraHD2","AuraHD7","AuraHD8","WR320"];for(i=0;i<models.length;i++)if(-1!==models[i].indexOf(gSTB.GetDeviceModelExt())){document.body.className=document.body.className+" new-buttons",useNewIcons=!0;break}MainPage.$loadingScreen=document.getElementById("loading"),MainPage.$loadingScreen.style.display="block",!EMULATION&&DEBUG&&DEBUG_NAME&&DEBUG_SERVER&&window.proxyServer&&(window.proxy=new proxyServer,window.proxy.init({name:DEBUG_NAME,host:DEBUG_SERVER})),"ru"!==curLangIdx&&"uk"!==curLangIdx&&(curLangIdx="en");try{appConfig=JSON.parse(appConfig)}catch(err){echo('JSON.parse(LoadUserData("ex.ua.data.json")); -> ERROR ->'+err),appConfig={contentLang:curLangIdx,interfaceLang:curLangIdx},gSTB.SaveUserData("ex.ua.data.json",JSON.stringify(appConfig))}window.typeInfo=content[appConfig.contentLang].typeInfo,window.mainPageMenu=content[appConfig.contentLang].mainPageMenu,appConfig.userId?getVersion():ajax("get",favApiUrl+"session",function(iData,status){try{iData=JSON.parse(iData)}catch(e){iData={data:{sid:""}}}echo("add new user Id: "+iData.data.sid),appConfig.userId=iData.data.sid,gSTB.SaveUserData("ex.ua.data.json",JSON.stringify(appConfig)),getVersion()},null,null,!1)},volume.init=function(){this.$container=document.body.getElementsByClassName("volumeContainer")[0],this.$mute=this.$container.querySelector(".mute"),this.$form=this.$container.querySelector(".volumeForm"),this.$bar=this.$form.querySelector("div")},volume.setVol=function(vol){var value,step_px=1920===screen.width?15:10,vol_idx=vol/5;echo("set volume="+vol),(vol>100||0>vol)&&(vol=100),this.timerId&&clearTimeout(this.timerId),this.$mute.style.display="none",vol_idx?(value=vol_idx*step_px-5,this.$bar.style.width=value+"px",this.muted&&this.toggleMute(),this.$form.style.display="block",this.$mute.style.display="none",this.timerId=setTimeout(function(){volume.timerId=null,volume.currVol>=5&&(volume.$form.style.display="none")},this.timeout)):(this.$form.style.display="none",this.timerId=null,this.currVol>=5&&(this.$form.style.display="none"),this.$mute.style.display="block"),gSTB.SetVolume(vol)},volume.toggleMute=function(){this.muted?(this.muted=!1,this.currVol>=5&&(this.$mute.style.display="none",clearTimeout(this.timerId),this.$form.style.display="block",this.timerId=setTimeout(function(){volume.$form.style.display="none"},this.timeout))):(this.$mute.style.display="block",this.muted=!0,this.timerId=null,this.currVol>=5&&(this.$form.style.display="none"),this.timerId&&clearTimeout(this.timerId)),gSTB.SetMute(this.muted?1:0)},MainPage.onInit=function(){this.$mainContent=this.handleInner.querySelector(".content .mainContent"),this.$typeList=this.handleInner.querySelector(".content .typeLst"),this.$catTypeName=this.handleInner.querySelector(".content  .mainContent  .servText"),this.LastActComp=null,this.typeList=new CScrollList(this),this.typeList.Init(this.handleInner.querySelector(".content .typeLst .cslist-main")),this.typeList.handleInner.onmouseover=function(){MainPage.typeList.isActive||(echo("onMouseOver->MainPage.typeList.Activate(true);"),MainPage.typeList.Activate(!0))};var $listItem,id_numb=0,$catGroupPlace=this.handleInner.querySelector(".content .cat_group");for(var level_0 in mainPageMenu){var cat=new CScrollList(this),flag=!0,$catHandler=$catGroupPlace.appendChild(element("div",{className:"cslist-main"}));cat.Init($catHandler);for(var level_1 in mainPageMenu[level_0])cat.Add(mainPageMenu[level_0][level_1].title,{news_data:mainPageMenu[level_0][level_1],focused:flag,onclick:function(){return echo("middle column onClick func,"),echo("this.news_data.url="+this.news_data.url),onClickFunc(this.news_data.url,this.news_data.rss,this.news_data.title,this.news_data.type),!1}}),flag&&(flag=!1);cat.iid=id_numb,$catHandler.onmouseover=function(){var curr_cat=MainPage.typeList.Current().cat;echo("onMouseOver->cat_"+curr_cat.iid+" Active?="+curr_cat.isActive),curr_cat.isActive||(echo("onMouseOver->cat_"+curr_cat.iid+".Activate(true);"),curr_cat.Activate(!0))},cat.onFocus=function(current,prev){MainPage.catOnFocus(current,prev)},cat.onDeactivate=function(){MainPage.$mainContent.className="crop mainContent notActive"},cat.onActivate=function(){MainPage.$mainContent.className="crop mainContent"},cat.Show(!1),echo("add typeListItem"+id_numb),$listItem=element("div",{className:"ctypeLst",id:"typeItem"+id_numb}),this.typeList.Add($listItem,{iid:id_numb,data:mainPageMenu[level_0],cat:cat,$catHandler:$catHandler,onclick:function(){return type_focus_timer&&(clearTimeout(type_focus_timer),MainPage.typeList.typeListActionFlag=!0),cat.Activate(!0),!1}}),id_numb++}this.typeList.onFocus=function(item,previous){var cat_name=[lang.catVideo,lang.catMusic,lang.catImages,lang.catFavourites];echo("we are going to show "+item.iid),MainPage.$catTypeName.innerHTML=cat_name[item.iid]+":",item.cat.Show(!0),void 0!==previous&&null!==previous&&(echo("we are going to hide "+previous.iid),previous.cat.Show(!1)),MainPage.typeList.actionFlag=!0,MainPage.catOnFocus(item.cat.Current())},this.typeList.onDeactivate=function(){MainPage.$typeList.className="typeLst notActive"},this.typeList.onActivate=function(){MainPage.$typeList.className="typeLst"},this.catOnFocus=function(item){var delay_time=500;echo("MainPage.categoryList.onFocus delay_time = 500;"),MainPage.typeList.actionFlag&&(delay_time=0,MainPage.typeList.actionFlag=!1,echo("MainPage.categoryList.onFocus  NOW delay_time = 0;")),cat_focus_timer&&clearTimeout(cat_focus_timer),cat_focus_timer=setTimeout(function(){item.news_data.newsCache[0].img_src?(MainPage.newsList.img1.firstChild.src=item.news_data.newsCache[1].img_src,MainPage.newsList.img2.firstChild.src=item.news_data.newsCache[2].img_src,MainPage.newsList.img3.firstChild.src=item.news_data.newsCache[3].img_src,MainPage.newsList.img0.firstChild.src=item.news_data.newsCache[0].img_src,MainPage.newsList.img0.news_link=item.news_data.newsCache[0].news_link,MainPage.newsList.img1.news_link=item.news_data.newsCache[1].news_link,MainPage.newsList.img2.news_link=item.news_data.newsCache[2].news_link,MainPage.newsList.img3.news_link=item.news_data.newsCache[3].news_link,echo("add news from cache")):(MainPage.currData=item,item.news_data.type===ROOT_FAVS?ajax("get",favApiUrl+"favorites/media?info.catId="+item.news_data.url,MainPage.favNewParser,{charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/x-www-form-urlencoded"},"json"):ajax("get",exURL+"/rss/"+item.news_data.rss,MainPage.rssParser,{charset:"utf-8"},"xml"))},delay_time)},this.newsList=new CScrollList(this),this.newsList.Init(this.handleInner.querySelector("#MainPage .content .rightContent .cslist-main")),this.newsList.handleInner.onmouseover=function(){MainPage.newsList.isActive||(echo("onMouseOver->MainPage.newsList.Activate(true);"),MainPage.newsList.Activate(!0))},this.newsList.onClickFunc=function(){echo("MainPage.newsList.onClickFunc");var data={type:WHAT_IS_THIS_TYPE,title:lang.newsBrCr,img_src:"img/"+screen.height+"/ex_ua_noposter.png",addtime:"n/a",url:MainPage.newsList.Current().news_link,iid:""};MainPage.LastActComp=MainPage.newsList,MainPage.messageHint=new CModalHint(MainPage,lang.loading),CSListManager.Open(data)};for(var content_type_level in mainPageMenu)for(var cats_level in mainPageMenu[content_type_level])for(var i=0;4>i;i++)mainPageMenu[content_type_level][cats_level].newsCache[i]={img_src:"",news_link:""};this.newsList.Clear(),this.newsList.img0=this.newsList.Add(element("img",{src:"img/"+screen.height+"/ex_ua_noposter.png",onclick:MainPage.newsList.onClickFunc}),{row:0,column:0,news_link:"#"}),this.newsList.img1=this.newsList.Add(element("img",{src:"img/"+screen.height+"/ex_ua_noposter.png",onclick:MainPage.newsList.onClickFunc}),{row:0,column:1,news_link:"#"}),this.newsList.img2=this.newsList.Add(element("img",{src:"img/"+screen.height+"/ex_ua_noposter.png",onclick:MainPage.newsList.onClickFunc}),{row:1,column:0,news_link:"#"}),this.newsList.img3=this.newsList.Add(element("img",{src:"img/"+screen.height+"/ex_ua_noposter.png",onclick:MainPage.newsList.onClickFunc}),{row:1,column:1,news_link:"#"}),this.newsList.onDeactivate=function(){MainPage.handleInner.querySelector(".content .rightContent").className="crop rightContent notActive",echo("MainPage.newsList.onDeactivate")},this.newsList.onActivate=function(){MainPage.handleInner.querySelector(".content .rightContent").className="crop rightContent"},this.SearchBar=new CSearchBar(this),this.SearchBar.Init("img/"+screen.height,this.handleInner.querySelector("#MainPage .header .csbar"),lang.langDefaultHint),this.SearchBar.onSearch=function(value){echo(value,"MainPage.SearchBar.onSearch");var data={title:value,value:encodeURI(value),url:typeInfo[ROOT_GLOBAL_SEARCH].urlStart+encodeURI(value),type:ROOT_GLOBAL_SEARCH};ListPage.start(data),MainPage.LastActComp=MainPage.typeList.Current().cat},this.SearchBar.onHint=function(hint){echo("onHint-> hint =->"+hint+"<-");var diff=hint.length-hint.trimLeft().length,clean_hint=hint.trimLeft();hint?ajax("get","http://www.ex.ua/r_search_hint?s="+encodeURI(clean_hint),function(html){echo("html=\n"+html);var sug_arr=html.split("\n");sug_arr&&sug_arr[0]&&clean_hint==sug_arr[0].substr(0,clean_hint.length)?MainPage.SearchBar.SetHint(hint.substr(0,diff)+sug_arr[0]):MainPage.SearchBar.SetHint("")}):(echo("empty value"),MainPage.SearchBar.SetHint(""))},this.SearchBar.onActivate=function(){gSTB.EnableVKButton(!0)},this.SearchBar.onDeactivate=function(){gSTB.EnableVKButton(!1),setTimeout(function(){MainPage.typeList.Current().cat.Activate(!0)},5)},this.actionRefresh=function(){echo("start refresh mainPageMenu.video[0].newsCache[0].img_src="+mainPageMenu.video[0].newsCache[0].img_src);for(var content_type_level in mainPageMenu)for(var cats_level in mainPageMenu[content_type_level])for(var i=0;4>i;i++)mainPageMenu[content_type_level][cats_level].newsCache[i].news_link="",mainPageMenu[content_type_level][cats_level].newsCache[i].img_src="";MainPage.typeList.actionFlag=!0,MainPage.typeList.Current().cat.onFocus(MainPage.typeList.Current().cat.Current()),echo("refresh is over mainPageMenu.video[0].newsCache[0].img_src="+mainPageMenu.video[0].newsCache[0].img_src)},this.actionLang=function(){echo("MainPage.actionLang"),new CModalSelectLang(MainPage,lang.changeLang,"",{})},this.BPanel=new CButtonPanel(this),this.BPanel.Init("img/"+screen.height,this.handleInner.querySelector("#MainPage .footer div.cbpanel-main")),this.BPanel.Add(KEYS.REFRESH,"ico_refresh.png",lang.refresh,this.actionRefresh),this.BPanel.Add(KEYS.F2,"ico_f2.png",lang.changeLang,this.actionLang),this.rssParser=function(data){var img_src,news_link,counter,i,place=MainPage.currData.news_data;for(echo("rssParser"),echo("place = "+place),i=0;4>i;i++)img_src=data.getElementsByTagName("description").item(i+1),news_link=data.getElementsByTagName("link").item(i+1)||"",null===img_src||null===img_src.firstChild||""===news_link?place.newsCache[i].img_src="img/"+screen.height+"/ex_ua_noposter.png?400":(news_link=news_link.firstChild.nodeValue,img_src=img_src.firstChild.nodeValue,echo("description->"+img_src),img_src.indexOf("<img")<0||img_src.indexOf("gif")>0?place.newsCache[i].img_src="img/"+screen.height+"/ex_ua_noposter.png?400":(img_src=img_src.substring(img_src.indexOf("<img")+10,img_src.indexOf("width")),img_src=img_src.substring(0,img_src.indexOf("?")),place.newsCache[i].img_src=img_src+"?400",echo("img mainPageMenu.video[category_index].newsCache[i].img_src="+place.newsCache[i].img_src))),place.newsCache[i].news_link=news_link;counter=0,MainPage.newsList.Each(function(item){checkForGiantImg(place.newsCache[counter].img_src,MAX_READABLE_IMAGE_WEIGHT,place.newsCache[counter],item.firstChild),item.news_link=place.newsCache[counter].news_link,echo("change cache elem"),counter++}),"block"===MainPage.$loadingScreen.style.display&&setTimeout(function(){MainPage.$loadingScreen.style.display="none"},100)},this.favNewParser=function(data){var counter,i,place=MainPage.currData.news_data;for(echo("favNewParser"),echo("place = "+place),data=data.data||[],i=0;4>i;i++)data[i]&&null!==data[i].info.img_src&&null!==data[i].info.img_src&&""!==data[i].info.img_src?(place.newsCache[i].img_src=data[i].info.img_src+"?400",echo("img mainPageMenu.video[category_index].newsCache[i].img_src="+place.newsCache[i].img_src)):place.newsCache[i].img_src="img/"+screen.height+"/ex_ua_noposter.png?400",place.newsCache[i].news_link=data[i]?data[i].info.url:"";counter=0,MainPage.newsList.Each(function(item){checkForGiantImg(place.newsCache[counter].img_src,MAX_READABLE_IMAGE_WEIGHT,place.newsCache[counter],item.firstChild),item.news_link=place.newsCache[counter].news_link,echo("change cache elem"),counter++}),"block"===MainPage.$loadingScreen.style.display&&setTimeout(function(){MainPage.$loadingScreen.style.display="none"},100)},this.Show(!0,null),echo("MainPage.start()"),this.newsList.onDeactivate(),this.typeList.onFocus(this.typeList.FindOne()),this.typeList.Activate(!0,!0)},MainPage.onShow=function(){MainPage.SearchBar.items.hint.value&&MainPage.SearchBar.items.hint.value!==lang.langDefaultHint&&(MainPage.SearchBar.items.hint.value="")},MainPage.EventHandler=function(event){if(echo("MainPage.EventHandler->activation status:"),echo("-typeList:  "+this.typeList.isActive),echo("-newsList:  "+this.newsList.isActive),echo("-SearchBar: "+this.SearchBar.isActive),event.code===KEYS.REFRESH&&this.actionRefresh(),event.code===KEYS.F2&&this.actionLang(),this.SearchBar.isActive)switch(event.code){case KEYS.RIGHT:echo("MainPage.SearchBar.items.hint.value="+this.SearchBar.items.hint.value),echo("MainPage.SearchBar.items.text.value="+this.SearchBar.items.text.value),setTimeout(function(){""!==MainPage.SearchBar.items.hint.value&&(MainPage.SearchBar.items.text.value=MainPage.SearchBar.items.hint.value,echo("new MainPage.SearchBar.items.text.value"+MainPage.SearchBar.items.text.value))},350);break;case KEYS.DOWN:case KEYS.F4:case KEYS.EXIT:echo("SearchBar down)))"),this.typeList.Current().cat.Activate(!0),event.preventDefault()}else if(this.typeList.isActive)switch(event.code){case KEYS.PAGE_DOWN:case KEYS.PAGE_UP:break;case KEYS.LEFT:break;case KEYS.OK:case KEYS.RIGHT:echo("To the right typeList)))"),this.typeList.Current().cat.Activate(!0);break;case KEYS.EXIT:case KEYS.BACK:this.actionExit();break;case KEYS.INFO:var refererPage=-1===(_GET.referrer||"").indexOf("online-media.infomir.com.ua")?"":"<br>Source: Online media";new CModalAlert(this,"Info",lang.programVersion+window.version+refererPage,lang.backAction,function(){});break;default:this.typeList.EventHandler(event)}else if(this.typeList.Current().cat.isActive){echo("-MainPage.typeList.Current().cat.isActive true");var curr_cat=this.typeList.Current().cat;switch(event.code){case KEYS.LEFT:echo("To the left categoryList)))"),this.typeList.Activate(!0);break;case KEYS.RIGHT:echo("To the right categoryList)))"),this.newsList.Activate(!0);break;case KEYS.OK:echo("keys->ok"),curr_cat.Current().onclick();break;case KEYS.EXIT:case KEYS.BACK:this.actionExit();break;default:curr_cat.EventHandler(event)}}else if(this.newsList.isActive){var current_news=this.newsList.Current();switch(event.code){case KEYS.PAGE_DOWN:case KEYS.PAGE_UP:break;case KEYS.LEFT:echo("To the LEFT typeList))) current_news.column="+current_news.column),current_news.column?this.newsList.Focused(this.newsList.Next("",!0),!0):this.typeList.Current().cat.Activate(!0);break;case KEYS.RIGHT:echo("To the RIGHT typeList))) current_news.column="+current_news.column),current_news.column||(this.newsList.Focused(this.newsList.Next(),!0),echo("r->next"));break;case KEYS.UP:echo("To the UP typeList))) current_news.row="+current_news.row),current_news.row&&this.newsList.Focused(this.newsList.Next("",!0,2),!0);break;case KEYS.DOWN:echo("To the DOWN typeList))) current_news.row="+current_news.row),current_news.row||this.newsList.Focused(this.newsList.Next("",!1,2),!0);break;case KEYS.OK:this.newsList.onClickFunc();break;case KEYS.EXIT:case KEYS.BACK:this.actionExit();break;default:this.newsList.EventHandler(event)}}event.code===KEYS.F4&&this.SearchBar.Activate(!0)},MainPage.actionExit=function(){window.parent!==window?window.parent.postMessage("hide","*"):this.exitMessage=new CModalConfirm(this,lang.exit,lang.closeQuestion,lang.cancel,function(){MainPage.exitMessage.Show(!1)},lang.mediaDefaultOk,function(){MediaPlayer.end(),window.location=decodeURIComponent(_GET.referrer)})},ListPage.onInit=function(){this.id=1,this.ItemsPerPage=32,CMODAL_IMG_PATH="img/"+screen.height,this.$infoMessage=ListPage.handleInner.querySelector(".infoMessage"),this.Info.Init(ListPage.$infoMessage),this.Info.Show(!1,!1),this.Preview.Init(this.handle.querySelector(".rightContent .info")),this.Preview.Show(!1,!1),ListPage.Preview.body=ListPage.Preview.handle.querySelector(".view"),ListPage.Preview.file=ListPage.Preview.handle.querySelector(".file"),this.Preview.showAttr="table-cell",this.Preview.infoIcon=element("img",{align:"left",src:"img/"+screen.height+"/ico_finfo.png"}),this.Preview.action_info={},this.Preview.action_info[ROOT_VIDEO]=this.Preview.infoFolder,this.Preview.action_info[ROOT_AUDIO]=this.Preview.infoFolder,this.Preview.action_info[ROOT_IMAGE]=this.Preview.infoFolder,this.Preview.action_info[TYPE_BACK]=this.Preview.infoBack,this.Preview.action_info[ROOT_GLOBAL_SEARCH]=this.Preview.infoFolder,this.Preview.action_info[LOCAL_SEARCH_ROOT]=this.Preview.infoFolder,this.Preview.action_info[TYPE_NONE]=this.Preview.infoFolder,this.Preview.action_info[MEDIA_OBJECT]=this.Preview.infoFolder,this.Preview.action_info[MEDIA_FOLDER]=this.Preview.infoFolder,this.Preview.action_info[RADIO_OBJECT]=this.Preview.infoFolder,this.Preview.action_info[ACTORS_FOLDER]=this.Preview.infoFolder,this.Preview.action_info[GLOBAL_SEARCH_FOLDER]=this.Preview.infoFolder,this.Preview.action_info[ORPHAN_FOLDER]=this.Preview.infoFolder,this.Preview.action_info[GLOBAL_SEARCH_REFRESH]=this.Preview.infoFolder,this.Preview.action_info[LOCAL_SEARCH_REFRESH]=this.Preview.infoFolder,this.Preview.action_info[WHAT_IS_THIS_TYPE]=this.Preview.infoFolder,this.Preview.action_info[ROOT_NEWS]=this.Preview.infoFolder,this.Preview.action_info[MEDIA_TYPE_VIDEO]=this.Preview.infoFile,this.Preview.action_info[MEDIA_TYPE_AUDIO]=this.Preview.infoFile,this.Preview.action_info[MEDIA_TYPE_IMAGE]=this.Preview.infoFile,this.breadCrumb=new CBreadCrumb(ListPage),this.breadCrumb.Init("img/"+screen.height,ListPage.handleInner.querySelector(".header .cbcrumb")),this.breadCrumb.showAttr="table-cell",this.breadCrumb.litems=2,this.breadCrumb.Show(!0),CSListManager.init(document.getElementById("manager"),ListPage),ListPage.subscribeEvents={},ListPage.subscribeEvents[MediaPlayer.EVENT_START]=function(){var time,file=CSListManager.Current().Current().data;echo("MediaPlayer.EVENT_START"),ListPage.Preview.player.className=file.type===MEDIA_TYPE_AUDIO?"player audio":"player play",ListPage.Preview.body.info&&void 0===ListPage.Preview.body.info.time&&MediaPlayer.totalTime>0&&(time=MediaPlayer.parseTime(MediaPlayer.totalTime),ListPage.Preview.body.info.time=element("div",{className:"text"},[lang.mediaMenuInfoDuration,element("span",{className:"txt"},time.hour+":"+time.min+":"+time.sec)]),elchild(ListPage.Preview.body.info,ListPage.Preview.body.info.time))},ListPage.subscribeEvents[MediaPlayer.EVENT_STOP]=function(){echo("MediaPlayer.EVENT_STOP"),ListPage.isVisible&&ListPage.Preview.player&&(ListPage.Preview.player.className="player stop",ListPage.Preview.setProgress(0))},ListPage.subscribeEvents[MediaPlayer.EVENT_PAUSE]=function(state){echo("MediaPlayer.EVENT_PAUSE");var file=CSListManager.Current().Current().data;state?ListPage.Preview.player.className="player stop":ListPage.Preview.player.className=file.type===MEDIA_TYPE_AUDIO?"player audio":"player play"},ListPage.subscribeEvents[MediaPlayer.EVENT_PROGRESS]=function(position){echo("MediaPlayer.EVENT_PROGRESS"),ListPage.Preview.setProgress(position)},ListPage.subscribeEvents[MediaPlayer.EVENT_ERROR]=function(){echo("MediaPlayer.EVENT_ERROR"),ListPage.Preview.player&&(ListPage.Preview.player.className="player stop",ListPage.Preview.setProgress(0)),new CModalHint(currCPage,lang.playingError,3e3)},ListPage.subscribeEvents[MediaPlayer.EVENT_OK]=function(){var file;echo("MediaPlayer.EVENT_OK"),ListPage.Preview.info(CSListManager.Current().Current().data),file=CSListManager.Current().Current().data,ListPage.Preview.player.className=file.type===MEDIA_TYPE_AUDIO?"player audio":"player play",gSTB.IsPlaying()&&MediaPlayer.runner.start(),MediaPlayer.Show(!1),MediaPlayer.changeScreenMode(!1)},ListPage.subscribeEvents[MediaPlayer.EVENT_EXIT]=function(){echo("MediaPlayer.EVENT_EXIT"),ListPage.Preview.setProgress(0),ListPage.Preview.player.className="player stop",ListPage.Preview.info(CSListManager.Current().Current().data)},ListPage.addListItems=function(obj){var somelistItem,i,j=0,current=CSListManager.Current(),data={};echo("ListPage.addListItems");for(i in obj){echo("list item add_"+j+"= <"+obj[i].title+">"),0===current.handleInner.page_index&&0===j&&(data={title:"",img_src:"",addtime:"",markable:!1,marked:!1,url:"",iid:"",type:TYPE_BACK},somelistItem=element("div",{className:"back"},".."),current.Add(somelistItem,{data:data,onclick:function(){return echo("onClick-> back"),setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5),!1}})),data={},data.type=obj[i].cat?MEDIA_FOLDER:MEDIA_OBJECT,(CSListManager.parentData.type===ROOT_GLOBAL_SEARCH||CSListManager.parentData.type===GLOBAL_SEARCH_REFRESH||CSListManager.parentData.type===LOCAL_SEARCH_ROOT||CSListManager.parentData.type===LOCAL_SEARCH_REFRESH)&&(data.type=obj[i].cat?GLOBAL_SEARCH_FOLDER:MEDIA_OBJECT),-1!==CSListManager.Current().handleInner.data.url.indexOf(typeInfo[RADIO_OBJECT].id)&&(data.type=RADIO_OBJECT,obj[i].add=""),-1!==CSListManager.Current().handleInner.data.url.indexOf(typeInfo[ACTORS_FOLDER].id)&&(data.type=ACTORS_FOLDER);var title_text=obj[i].title,elem=element("span",{},""),css_class=obj[i].cat?"cat":"obj";-1!==MainPage.favsList.urls.indexOf(obj[i].url)&&(css_class+=" fav"),elem.innerHTML=title_text,title_text=elem.innerHTML,data.img_src=obj[i].img,data.addtime=obj[i].add,data.url=obj[i].url,data.title=title_text,data.markable=!0,data.iid=current.handleInner.page_index*ListPage.ItemsPerPage+j,somelistItem=element("div",{className:css_class,innerHTML:title_text}),current.Add(somelistItem,{data:data,onclick:function(){return echo(this.data,"onClick->EnterData="),CSListManager.Open(this.data),!1}});var check_data=CSListManager.Current().handleInner.children[current.handleInner.page_index*ListPage.ItemsPerPage+j+1].data;echo("*******url for check "+check_data.img_src),check_data.img_src&&checkForGiantImg(check_data.img_src,MAX_READABLE_IMAGE_WEIGHT,check_data),j++}obj.length>0?(current.handleInner.page_index+=Math.ceil(j/ListPage.ItemsPerPage),current.handleInner.page_length=current.handleInner.page_index,echo("new page_index="+current.handleInner.page_index+" was added pages="+Math.ceil(j/ListPage.ItemsPerPage))):(current.handleInner.page_length=current.handleInner.page_index-1,echo("end page_index="+current.handleInner.page_index),0===current.handleInner.page_index&&(data={title:"",img_src:"",addtime:"",markable:!1,marked:!1,url:"",iid:"",type:TYPE_BACK},somelistItem=element("div",{className:"back"},".."),current.Add(somelistItem,{data:data,onclick:function(){return echo("onClick-> back"),setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5),!1}}))),current.Activate(!0),CSListManager.Current().onFocus(CSListManager.Current().Current(),!0)},ListPage.onFocusAction=function(current,previous){echo("list on focus"),ListPage.isVisible&&(MediaPlayer.end(),cat_focus_timer&&clearTimeout(cat_focus_timer),cat_focus_timer=setTimeout(function(){try{ListPage.Preview.info(CSListManager.Current().Current().data)}catch(e){echo("wrong info update time! "+e)}cat_focus_timer=0},500))},this.SearchBar=new CSearchBar(ListPage),this.SearchBar.Init("img/"+screen.height,ListPage.handleInner.querySelector(".header .csbar"),lang.listDefaultHint),this.SearchBar.showAttr="table-cell",this.SearchBar.onSearch=function(value){var data={};echo(value,"ListPage.SearchBar.onSearch"),data.title=value,data.value=encodeURI(value),CSListManager.parentData.type===ROOT_GLOBAL_SEARCH||CSListManager.parentData.type===GLOBAL_SEARCH_REFRESH?(data.url=typeInfo[ROOT_GLOBAL_SEARCH].urlStart+data.value,data.type=GLOBAL_SEARCH_REFRESH):CSListManager.parentData.type===LOCAL_SEARCH_REFRESH||CSListManager.parentData.type===LOCAL_SEARCH_ROOT?(echo(value,"MainPage.SearchBar.onSearch"),data.url=typeInfo[LOCAL_SEARCH_ROOT].urlStart+CSListManager.src[0].handleInner.data.real_cat_id+typeInfo[LOCAL_SEARCH_ROOT].urlEnd+data.value,data.type=LOCAL_SEARCH_REFRESH):(echo(value,"MainPage.SearchBar.onSearch"),data.url=typeInfo[LOCAL_SEARCH_ROOT].urlStart+CSListManager.src[0].handleInner.data.real_cat_id+typeInfo[LOCAL_SEARCH_ROOT].urlEnd+data.value,data.type=LOCAL_SEARCH_ROOT,CSListManager.mode=LSEARCH_MODE),CSListManager.Open(data),ListPage.breadCrumb.Show(!0)},this.SearchBar.onHint=function(hint){var diff=hint.length-hint.trimLeft().length,clean_hint=hint.trimLeft();echo("onHint-> hint =->"+hint+"<-"),hint?ajax("get","http://www.ex.ua/r_search_hint?s="+encodeURI(clean_hint),function(html){var sug_arr;echo("html=\n"+html),html?(sug_arr=html.split("\n"),clean_hint===sug_arr[0].substr(0,clean_hint.length)?MainPage.SearchBar.SetHint(hint.substr(0,diff)+sug_arr[0]):MainPage.SearchBar.SetHint("")):ListPage.SearchBar.SetHint("")}):(echo("empty value"),ListPage.SearchBar.SetHint(""))},ListPage.SearchBar.onActivate=function(){ListPage.breadCrumb.Show(!1),gSTB.EnableVKButton(!0)},ListPage.SearchBar.onDeactivate=function(){ListPage.breadCrumb.Show(!0),gSTB.EnableVKButton(!1),setTimeout(function(){CSListManager.Current().Activate(!0)},5)},ListPage.BPanel=new CButtonPanel(ListPage),ListPage.BPanel.Init("img/"+screen.height,ListPage.handleInner.querySelector(".footer div.cbpanel-main")),ListPage.BPanel.btnMenu=ListPage.BPanel.Add(KEYS.MENU,useNewIcons?"new/menu2.png":"ico_menu.png",lang.mainMenu,ListPage.actionMainMenu),ListPage.BPanel.btnF3mark=ListPage.BPanel.Add(KEYS.F2,"ico_f2.png",lang.mark,ListPage.actionF3),ListPage.BPanel.btnF1=ListPage.BPanel.Add(KEYS.F1,"ico_f1.png",lang.download,ListPage.actionF1),ListPage.BPanel.btnOnINFO=ListPage.BPanel.Add(KEYS.INFO,useNewIcons?"new/info2.png":"ico_info.png",lang.filmDescription,ListPage.actionINFO),ListPage.BPanel.btnOffINFO=ListPage.BPanel.Add(KEYS.INFO,useNewIcons?"new/info2.png":"ico_info.png",lang.filmDescriptionOff,ListPage.actionBack),ListPage.BPanel.btnOKINFO=ListPage.BPanel.Add(KEYS.OK,"ico_ok.png",lang.toFiles,ListPage.objShortCut),ListPage.BPanel.btnF3add=ListPage.BPanel.Add(KEYS.F3,"ico_f3.png",lang.toFavs,ListPage.actionToFavs),ListPage.BPanel.btnF3del=ListPage.BPanel.Add(KEYS.F3,"ico_f3.png",lang.fromFavs,ListPage.actionFromFavs),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOKINFO,!0),ListPage.addObjectItems=function(obj){echo("ListPage.addObjectItems");var somelistItem,cont_type,item,elem,i=0,data={},media_types=[MEDIA_TYPE_VIDEO,MEDIA_TYPE_AUDIO,MEDIA_TYPE_IMAGE],current=CSListManager.Current();for(cont_type in obj){0===i&&(data.img_big="",data.img_prev="",data.title="",data.url="",data.markable=!1,data.marked=!1,data.type=TYPE_BACK,somelistItem=element("div",{className:"back"},".."),current.Add(somelistItem,{data:data,focused:!0,onclick:function(){return echo("onClick-> back"),setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5),!1}}));for(item in obj[cont_type])elem=element("span",{},""),elem.innerHTML=obj[cont_type][item].name,obj[cont_type][item].name=elem.innerHTML,data={type:media_types[i],markable:!0,marked:!1,img_big:obj[cont_type][item].img_big,img_prev:obj[cont_type][item].img_prev,name:obj[cont_type][item].name,title:obj[cont_type][item].name,url:obj[cont_type][item].url,sizeInBytes:obj[cont_type][item].sizeInBytes,resolution:obj[cont_type][item].resolution},CSListManager.parentData.type===RADIO_OBJECT&&(obj[cont_type][item].type="stream"),somelistItem=element("div",{className:obj[cont_type][item].type,innerHTML:obj[cont_type][item].name}),current.Add(somelistItem,{data:data,onclick:function(){return echo("PLAY data.type="+data.type),CSListManager.Open(this.data),!1}});i++}ListPage.messageHint&&ListPage.messageHint.Show(!1),0===obj.length&&(data.img_big="",data.img_prev="",data.title="",data.url="",data.markable=!1,data.marked=!1,data.type=TYPE_BACK,somelistItem=element("div",{className:"back"},".."),current.Add(somelistItem,{data:data,focused:!0,onclick:function(){return echo("onClick-> back"),setTimeout(function(){CSListManager.Open({type:TYPE_BACK})},5),!1}})),CSListManager.Current().Activate(!0),CSListManager.Current().onFocus(CSListManager.Current().Current(),!0)},ListPage.start=function(data){echo("we are starting page 2 with type "+data.type),CSListManager.Open(data),ListPage.Show(!0,MainPage)},ListPage.Preview.playerRect=ListPage.Preview.getRect(),ListPage.Preview.Show(!0,!1)},ListPage.onShow=function(){echo("ListPage onShow"),0!==CSListManager.src.length&&CSListManager.Current().Activate(),CSListManager.parentData.type!==ROOT_GLOBAL_SEARCH?(this.SearchBar.items.text.value||this.SearchBar.items.hint.value&&this.SearchBar.items.hint.value!==lang.listDefaultHint)&&(this.SearchBar.items.hint.value=lang.listDefaultHint,this.SearchBar.items.text.value=""):(this.SearchBar.items.hint.value="",this.SearchBar.items.text.value=CSListManager.parentData.title),MediaPlayer.setCoord(ListPage.Preview.playerRect.x,ListPage.Preview.playerRect.y,ListPage.Preview.playerRect.a,ListPage.Preview.playerRect.b),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_START),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_STOP),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_PAUSE),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_PROGRESS),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_ERROR),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_OK),MediaPlayer.Subscribe(ListPage,MediaPlayer.EVENT_EXIT)},ListPage.actionExit=function(){ListPage.exitMessage=new CModalConfirm(currCPage,lang.exit,lang.closeQuestion,lang.cancel,function(){
ListPage.exitMessage.Show(!1)},lang.close,function(){MediaPlayer.end(),window.location=decodeURIComponent(_GET.referrer)})},ListPage.actionBack=function(){var type,currItem;echo("ListPage action Back"),ListPage.Info.isActive?(currItem=CSListManager.Current().Current(),ListPage.Info.f3_visibility_flag===!0&&(ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!1),ListPage.Info.f3_visibility_flag=!1),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!(currItem.data.type===MEDIA_OBJECT&&-1===MainPage.favsList.urls.indexOf(currItem.data.url))),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!(currItem.data.type===MEDIA_OBJECT&&-1!==MainPage.favsList.urls.indexOf(currItem.data.url))),type=currItem.data.type,type===MEDIA_TYPE_VIDEO||type===MEDIA_TYPE_AUDIO||type===MEDIA_TYPE_IMAGE?ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!1):ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!1),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOKINFO,!0),ListPage.Info.Show(!1,!0),CSListManager.SearchBarVisibility&&ListPage.SearchBar.Show(!0,!1),CSListManager.Current().Activate(!0)):CSListManager.Open({type:TYPE_BACK})},ListPage.actionToFavs=function(){var currItem,currItemData,currType;echo("clicked F4add"),currItem=CSListManager.Current().Current(),currType=currItem.data.type,currItemData=currType===MEDIA_TYPE_VIDEO||currType===MEDIA_TYPE_AUDIO||currType===MEDIA_TYPE_IMAGE?CSListManager.Current().handle.data:CSListManager.Current().Current().data,currItemData.catId=MainPage.typeList.Current().iid,(currItemData.type===MEDIA_FOLDER||currItemData.type===ORPHAN_FOLDER)&&(currItemData.cat=!0),ajax("POST",favApiUrl+"favorites/media",function(a,b){echo("AJAX add to favs, ansv:"+a+" , "+b),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!1),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!0),ajax("get","http://api.magapps.net/v1/favorites/media?info.url="+currItemData.url,function(data){echo("AJAX check if it has been correctly added to favs:"+data);var favId;try{favId=JSON.parse(data).data[0].id}catch(e){echo("AJAX check if it has been correctly added to favs:ERROR"),favId=""}favId&&(MainPage.favsList.idsByUrl[currItemData.url]=favId,MainPage.favsList.urls.push(currItemData.url),currItem.firstChild.className+=" fav")},{charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/x-www-form-urlencoded"})},{charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/json"},"",void 0,JSON.stringify(currItemData))},ListPage.actionFromFavs=function(){var currItem,currItemData,currType,itemToDelete;echo("clicked F4del"),currItem=CSListManager.Current().Current(),currType=currItem.data.type,currItemData=currType===MEDIA_TYPE_VIDEO||currType===MEDIA_TYPE_AUDIO||currType===MEDIA_TYPE_IMAGE?CSListManager.Current().handle.data:CSListManager.Current().Current().data,echo("currItemData.favId:"+MainPage.favsList.idsByUrl[currItemData.url]),ajax("delete",favApiUrl+"favorites/media/"+MainPage.favsList.idsByUrl[currItemData.url],function(a,b){echo("AJAX del from favs, ansv:"+a+" , "+b)},{charset:"utf-8",Authorization:MainPage.userId,"Content-Type":"application/x-www-form-urlencoded"}),MainPage.favsList.idsByUrl[currItemData.url]=void 0,MainPage.favsList.urls.splice(MainPage.favsList.urls.indexOf(currItemData.url),1),3===MainPage.typeList.activeItem.iid&&currType!==MEDIA_TYPE_VIDEO&&currType!==MEDIA_TYPE_AUDIO&&currType!==MEDIA_TYPE_IMAGE?(itemToDelete=CSListManager.Current().Current(),CSListManager.Current().Focused(CSListManager.Current().Next({},!0),!0),CSListManager.Current().Delete(itemToDelete)):(ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!1),currItem.firstChild.className="obj")},ListPage.objShortCut=function(){var data=CSListManager.Current().Current().data,type=data.type;ListPage.actionBack(),type!==MEDIA_TYPE_VIDEO&&type!==MEDIA_TYPE_AUDIO&&type!==MEDIA_TYPE_IMAGE&&CSListManager.Open(data)},ListPage.actionMainMenu=function(){for(ListPage.SearchBar.Show(!0,!1),MediaPlayer.end(),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!1),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOKINFO,!0),ListPage.Info.Show(!1,!1);CSListManager.src.length>0;)ListPage.breadCrumb.Pop(),CSListManager.src.length--;for(;CSListManager.handleInner.lastChild;)CSListManager.handleInner.removeChild(CSListManager.handleInner.lastChild);echo("---PAGE CHANGE---"),ListPage.Show(!1),MainPage.LastActComp.Activate(!0,!0)},ListPage.actionF3=function(move){var item;echo("ListPage action F3"),ListPage.BPanel.btnF3mark.data.hidden||(item=CSListManager.Current().Current(),item.data.markable&&CSListManager.Current().Marked(item,!item.marked)&&move!==!1&&CSListManager.Current().Focused(CSListManager.Current().Next(),!0))},ListPage.actionF1=function(){var items;echo("ListPage action F1"),items=CSListManager.Current().Find({marked:!0}),echo("FOUND marked items?"),0===items.length&&CSListManager.Current().Current().data.markable&&(echo("NOPE, take curr"),items=[CSListManager.Current().Current()]),items.length&&new CModalAddDownload(ListPage,items)},ListPage.actionINFO=function(){var type=CSListManager.Current().Current().data.type;echo("ListPage.actionINFO=>ajax="+CSListManager.Current().handleInner.data.url),type!==MEDIA_TYPE_VIDEO&&type!==MEDIA_TYPE_AUDIO&&type!==MEDIA_TYPE_IMAGE?ajax("GET",CSListManager.Current().Current().data.url,htmlObjectInfoParser):ajax("GET",CSListManager.Current().handleInner.data.url,htmlObjectInfoParser)},ListPage.EventHandler=function(event){if(eventPrepare(event))if(echo("ListPage.EventHandler"),ListPage.SearchBar.isActive)switch(echo("SearchBar.event.code="+event.code),event.code){case KEYS.RIGHT:echo("To the right SearchBar)))"),""!==ListPage.SearchBar.items.hint.value&&(ListPage.SearchBar.items.text.value=MainPage.SearchBar.items.hint.value);break;case KEYS.DOWN:case KEYS.EXIT:echo("SearchBar down)))"),event.preventDefault();break;default:ListPage.SearchBar.EventHandler(event)}else if(CSListManager.Current().isActive)switch(echo("CSListManager.Current().keyHandler="+CSListManager.Current().isActive),event.code){case KEYS.F4:CSListManager.SearchBarVisibility!==!0||ListPage.Info.isActive||ListPage.SearchBar.Activate(!0);break;case KEYS.EXIT:case KEYS.BACK:ListPage.actionBack();break;case KEYS.F1:case KEYS.F3:case KEYS.F2:case KEYS.MENU:case KEYS.INFO:ListPage.BPanel.EventHandler(event);break;case KEYS.PLAY_PAUSE:ListPage.Preview.playPause();break;case KEYS.STOP:MediaPlayer.end();break;default:CSListManager.Current().EventHandler(event)}else if(ListPage.Info.isActive)switch(echo("ListPage.Info.keyHandler="),ListPage.$infoMessage.focus(),event.code){case KEYS.BACK:case KEYS.INFO:case KEYS.EXIT:ListPage.actionBack();break;case KEYS.F3:case KEYS.MENU:case KEYS.OK:ListPage.BPanel.EventHandler(event);break;case KEYS.DOWN:ListPage.$infoMessage.scrollByLines(3);break;case KEYS.UP:ListPage.$infoMessage.scrollByLines(-3);break;case KEYS.PAGE_DOWN:ListPage.$infoMessage.scrollByPages(1);break;case KEYS.PAGE_UP:ListPage.$infoMessage.scrollByPages(-1)}},ListPage.Preview.setProgress=function(value){echo("ListPage.Preview.setProgress->"+value),ListPage.Preview.pgval&&(value>=100&&(value=100),0>value&&(value=0),ListPage.Preview.pgval.style.width=value+"%")},ListPage.Preview.setPosition=function(data){var item,i,l;if(echo(data,"ListPage.Preview.setPosition "),data)for(i=0,l=CSListManager.Current().handleInner.children.length;l>i;i++)if(item=CSListManager.Current().handleInner.children[i],data.type===item.data.type&&data.url===item.data.url&&data.name===item.data.name)return CSListManager.Current().Focused(item,!0);return!1},ListPage.Preview.playPause=function(){var file,list=[];echo("ListPage.Preview.playPause"),echo(MediaPlayer.list,"MediaPlayer.list 0"),MediaPlayer.playNow||null!==MediaPlayer.obj?MediaPlayer.playPause():(file=CSListManager.Current().Current(),-1!==CSListManager.playable.indexOf(file.data.type)&&(this.player.className="player load",list=MediaPlayer.addPreviewList(),echo(list,"MediaPlayer.preparePlayer(list,"),MediaPlayer.preparePlayer(list,ListPage,!1,!0,!1),echo(MediaPlayer.list,"MediaPlayer.list 1"),file.data.type===MEDIA_TYPE_IMAGE&&(ListPage.Preview.player.className="player play")))},ListPage.Preview.getRect=function(){var videoMode=gSTB.RDir("vmode");switch(videoMode){case"480i":case"480p":return{x:457,y:97,a:218,b:140};case"576i":case"576p":return{x:457,y:108,a:219,b:140};case"720p":case"720p60":switch(screen.width){case 720:return{x:837,y:129,a:389,b:177};case 1280:return{x:830,y:129,a:394,b:220}}break;case"1080i":case"1080i60":case"1080p":case"1080p60":switch(screen.width){case 720:return{x:1253,y:205,a:584,b:260};case 1280:return{x:1245,y:192,a:588,b:330};case 1920:return{x:1247,y:194,a:591,b:330}}}return{x:0,y:0,a:0,b:0}},ListPage.Preview.bytesToSize=function(bytes,precision){var kilobyte=1024,megabyte=1024*kilobyte,gigabyte=1024*megabyte,terabyte=1024*gigabyte;return bytes>=0&&kilobyte>bytes?bytes+" B":bytes>=kilobyte&&megabyte>bytes?(bytes/kilobyte).toFixed(precision)+" KB":bytes>=megabyte&&gigabyte>bytes?(bytes/megabyte).toFixed(precision)+" MB":bytes>=gigabyte&&terabyte>bytes?(bytes/gigabyte).toFixed(precision)+" GB":bytes>=terabyte?(bytes/terabyte).toFixed(precision)+" TB":bytes+" B"},ListPage.Preview.info=function(data){echo(data,"ListPage.Preview.info"),data&&data.type&&ListPage.Preview.action_info[data.type]instanceof Function?ListPage.Preview.action_info[data.type].call(this,data):echo("wrong info type")},ListPage.Preview.infoFolder=function(data){var size=rightMenuTextLength,name=data.title.substr(0,size-1)+(data.title.length>size?"...":"");echo(data,"infoFolder"),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!1),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!(data.type===MEDIA_OBJECT&&-1===MainPage.favsList.urls.indexOf(data.url))),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!(data.type===MEDIA_OBJECT&&-1!==MainPage.favsList.urls.indexOf(data.url))),elchild(elclear(this.body),element("div",{},[element("img",{className:"itemImg",src:data.img_src}),element("div",{className:"text"},[lang.description,element("span",{className:"txt"},name.split("").join("​"))]),element("div",{className:"text"},[lang.addTime,element("span",{className:"txt"},data.addtime)])]))},ListPage.Preview.infoFile=function(data){var sizeInBytes,self=this,size=rightMenuTextLength,name=data.name.substr(0,size-1)+(data.name.length>size?"...":"");echo(data,"infoFile"),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!1),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!1),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!1),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!0),CSListManager.Current().Current().marked?ListPage.BPanel.btnF3mark.children[1].innerHTML=lang.unmark:ListPage.BPanel.btnF3mark.children[1].innerHTML=lang.mark,echo("name 0= "+data.name),sizeInBytes=data.sizeInBytes?""===data.sizeInBytes?"":ListPage.Preview.bytesToSize(Number(data.sizeInBytes.split(",").join("")),1):0,echo("name 1= "+name),elchild(elclear(this.body),this.body.info=element("div",{},[element("div",{className:"file"},[this.player=element("div",{className:"player stop",onclick:function(){self.playPause(),setTimeout(function(){CSListManager.Current().Activate()},5)}}),this.pgbar=element("div",{className:"pgbar"}),this.pgval=element("div",{className:"pgval"})]),element("div",{className:"text fleft"},[lang.description,element("span",{className:"txt"},name.split("").join("​"))]),this.file_size=element("div",{className:"text"},[lang.sizeInBytes,element("span",{className:"txt"},sizeInBytes)])])),echo("name 2= "+name.split("").join("​")),data.type===MEDIA_TYPE_IMAGE&&ListPage.Preview.playPause()},ListPage.Preview.infoBack=function(){echo("infoBack"),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!0),CSListManager.parent.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!0),elchild(elclear(this.body),element("div",{className:"preview_back"},[this.infoIcon,element("div",{className:"text"},lang.mediaMenuInfoBackAct)]))},ListPage.Info.start=function(html){var itemData=CSListManager.Current().Current().data,type=itemData.type;echo("ListPage.Info.start"),ListPage.SearchBar.Show(!1,!1),CSListManager.parent.BPanel.btnF3mark.data.hidden||(ListPage.Info.f3_visibility_flag=!0,ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3mark,!0)),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF1,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOnINFO,!0),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOffINFO,!1),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnOKINFO,!1),elchild(elclear(ListPage.$infoMessage),element("div",{className:"messText",innerHTML:html})),itemData=type!==MEDIA_TYPE_VIDEO&&type!==MEDIA_TYPE_AUDIO&&type!==MEDIA_TYPE_IMAGE?CSListManager.Current().Current().data:CSListManager.Current().handle.data,ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3add,!(itemData.type===MEDIA_OBJECT&&-1===MainPage.favsList.urls.indexOf(itemData.url))||3===MainPage.typeList.activeItem.iid),ListPage.BPanel.Hidden(CSListManager.parent.BPanel.btnF3del,!(itemData.type===MEDIA_OBJECT&&-1!==MainPage.favsList.urls.indexOf(itemData.url))||3===MainPage.typeList.activeItem.iid),ListPage.Info.Show(!0,!0),ListPage.Info.Activate(),setTimeout(function(){var button=ListPage.$infoMessage.querySelector(".r_button");button&&(button.innerHTML="")},200)};